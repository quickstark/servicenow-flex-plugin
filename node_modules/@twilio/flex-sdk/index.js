/*!
 * 
 * @twilio/flex-sdk.js 0.4.3
 * The following license applies to all parts of this software except as documented below.
 * 
 * Copyright (c) 2020 Twilio, Inc.
 * All rights reserved.
 * 
 * Licensed under the Apache License, Version 2.0 (the “License”);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 * 
 *     http://www.apache.org/licenses/LICENSE-2.0
 * 
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an “AS IS” BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * 
 */
module.exports=function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=106)}([function(e,t){e.exports=require("inversify")},function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"e",(function(){return k})),n.d(t,"d",(function(){return w})),n.d(t,"b",(function(){return h})),n.d(t,"c",(function(){return A}));var r,o;n(94),n(85);function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}!function(e){e[e.Forbidden=403]="Forbidden",e[e.InvalidParams=400]="InvalidParams",e[e.InvalidState=409]="InvalidState",e[e.NotFound=404]="NotFound",e[e.SDK=500]="SDK",e[e.Unknown=501]="Unknown",e[e.UntrustedDomain=70002]="UntrustedDomain",e[e.InvalidCertificate=70251]="InvalidCertificate",e[e.InvalidSSO=45212]="InvalidSSO",e[e.InvalidAccountSid=45213]="InvalidAccountSid",e[e.InvalidAccessToken=20101]="InvalidAccessToken",e[e.AccessTokenExpired=20104]="AccessTokenExpired",e[e.ValidationError=45004]="ValidationError",e[e.AuthorizationError=45003]="AuthorizationError",e[e.PermissionDeniedError=20003]="PermissionDeniedError",e[e.UnsupportedMediaError=20415]="UnsupportedMediaError",e[e.TwilsockConnectionError=51216]="TwilsockConnectionError",e[e.SyncAccessForbiddenError=54007]="SyncAccessForbiddenError",e[e.SyncMapNotFoundError=54200]="SyncMapNotFoundError",e[e.SyncMapItemNotFoundError=54201]="SyncMapItemNotFoundError",e[e.SyncInvalidMapItemDataError=54206]="SyncInvalidMapItemDataError",e[e.SyncInvalidMapItemKeyError=54209]="SyncInvalidMapItemKeyError",e[e.SyncNameNotFoundError=54300]="SyncNameNotFoundError",e[e.SyncNameAlreadyExistsError=54301]="SyncNameAlreadyExistsError",e[e.SyncInvalidNameError=54302]="SyncInvalidNameError",e[e.SyncConnectionError=45307]="SyncConnectionError",e[e.TooManyRequests=20429]="TooManyRequests"}(o||(o={}));var c=(i(r={},o.Forbidden,"User is not authorized to perform the requested operation"),i(r,o.InvalidParams,"Invalid parameters"),i(r,o.InvalidState,"Invalid state"),i(r,o.NotFound,"Resource not found"),i(r,o.TooManyRequests,"Too many requests"),i(r,o.SDK,"Generic error from inner SDK"),i(r,o.Unknown,"Unknown error"),i(r,o.UntrustedDomain,"Validation error: invalid domain"),i(r,o.InvalidCertificate,"Validation error: invalid certificate"),i(r,o.InvalidSSO,"Validation error: invalid SSO"),i(r,o.InvalidAccountSid,"Validation error: invalid account sid"),i(r,o.InvalidAccessToken,"Invalid Access Token"),i(r,o.AccessTokenExpired,"Access Token expired or expiration date invalid"),i(r,o.ValidationError,"Validation error: request body validation fails"),i(r,o.AuthorizationError,"Attempt to access resource where access is not allowed for given credentials"),i(r,o.PermissionDeniedError,"You lack permission to the resource and method you requested"),i(r,o.UnsupportedMediaError,"The server does not support the media type transmitted in the request"),i(r,o.TwilsockConnectionError,"Twilsock connection error"),i(r,o.SyncAccessForbiddenError,"Sync access forbidden for identity"),i(r,o.SyncMapNotFoundError,"Sync map not found"),i(r,o.SyncInvalidMapItemDataError,"Invalid sync map item data"),i(r,o.SyncInvalidMapItemKeyError,"Invalid sync map item key"),i(r,o.SyncMapItemNotFoundError,"Sync map item not found"),i(r,o.SyncNameNotFoundError,"Sync unique name not found"),i(r,o.SyncNameAlreadyExistsError,"Sync unique name already exists"),i(r,o.SyncInvalidNameError,"Sync invalid unique name"),i(r,o.SyncConnectionError,"Sync connection error"),r);function a(e){return!!Object.values(o).find((function(t){return t===e}))}n(2),n(4),n(7),n(5),n(9),n(22),n(19),n(53),n(15),n(44),n(38),n(40),n(30),n(16),n(17);function u(e){return(u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function s(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function f(e,t){return!t||"object"!==u(t)&&"function"!=typeof t?l(e):t}function l(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function p(e){var t="function"==typeof Map?new Map:void 0;return(p=function(e){if(null===e||(n=e,-1===Function.toString.call(n).indexOf("[native code]")))return e;var n;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,r)}function r(){return d(e,arguments,b(this).constructor)}return r.prototype=Object.create(e.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),y(r,e)})(e)}function d(e,t,n){return(d=v()?Reflect.construct:function(e,t,n){var r=[null];r.push.apply(r,t);var o=new(Function.bind.apply(e,r));return n&&y(o,n.prototype),o}).apply(null,arguments)}function v(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function y(e,t){return(y=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function b(e){return(b=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var h=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&y(e,t)}(u,e);var t,n,r,o,i=(t=u,function(){var e,n=b(t);if(v()){var r=b(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return f(this,e)});function u(e,t,n){var r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,u);var o,s=void 0!==t?": ".concat(t):"",f="".concat((o=e,a(o)?c[o]:"Error")).concat(s);return(r=i.call(this,f))._errorCode=e,r._source=n,r._details=t,Object.setPrototypeOf(l(r),u.prototype),r}return n=u,(r=[{key:"code",get:function(){return this._errorCode}},{key:"details",get:function(){return this._details}},{key:"source",get:function(){return this._source}}])&&s(n.prototype,r),o&&s(n,o),u}(p(Error));function m(e,t,n,r,o,i,c){try{var a=e[i](c),u=a.value}catch(e){return void n(e)}a.done?t(u):Promise.resolve(u).then(r,o)}function g(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function c(e){m(i,r,o,c,a,"next",e)}function a(e){m(i,r,o,c,a,"throw",e)}c(void 0)}))}}function w(e){e.code&&a(e.code)||console.warn("Unknown error code");var t=e.code?e.code:o.Unknown;throw new h(t,e.message)}function k(e,t){return S.apply(this,arguments)}function S(){return(S=g(regeneratorRuntime.mark((function e(t,n){var r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.json();case 2:(r=e.sent).message=n||r.message,w(r);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function j(e){return(j="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function x(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function O(e,t){return!t||"object"!==j(t)&&"function"!=typeof t?C(e):t}function C(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function P(e){var t="function"==typeof Map?new Map:void 0;return(P=function(e){if(null===e||(n=e,-1===Function.toString.call(n).indexOf("[native code]")))return e;var n;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,r)}function r(){return E(e,arguments,I(this).constructor)}return r.prototype=Object.create(e.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),R(r,e)})(e)}function E(e,t,n){return(E=T()?Reflect.construct:function(e,t,n){var r=[null];r.push.apply(r,t);var o=new(Function.bind.apply(e,r));return n&&R(o,n.prototype),o}).apply(null,arguments)}function T(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function R(e,t){return(R=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function I(e){return(I=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var A=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&R(e,t)}(r,e);var t,n=(t=r,function(){var e,n=I(t);if(T()){var r=I(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return O(this,e)});function r(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Internal Error";return x(this,r),e=n.call(this,t),Object.setPrototypeOf(C(e),r.prototype),e}return r}(P(Error))},function(e,t){e.exports=require("core-js/modules/es.object.to-string")},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var o;n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return c.a})),n.d(t,"c",(function(){return c.c})),n.d(t,"d",(function(){return a.b})),n.d(t,"e",(function(){return a.d})),function(e){e.Trace="trace",e.Debug="debug",e.Info="info",e.Warn="warn",e.Error="error"}(o||(o={}));var i=function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:o.Debug;r(this,e),this.loggerName=t,this.severity=n,this.timestamp=new Date,this.context={}},c=n(43),a=n(14)},function(e,t){e.exports=require("core-js/modules/es.promise")},function(e,t){e.exports=require("core-js/modules/es.symbol")},function(e,t,n){"use strict";var r=n(24);n.d(t,"b",(function(){return r.b})),n.d(t,"a",(function(){return r.a})),n.d(t,"d",(function(){return r.e})),n.d(t,"e",(function(){return r.g})),n.d(t,"c",(function(){return r.d}))},function(e,t){e.exports=require("regenerator-runtime/runtime")},function(e,t,n){"use strict";var r=n(28);n.d(t,"b",(function(){return r.c}));var o=n(69);n.d(t,"a",(function(){return o.a}))},function(e,t){e.exports=require("core-js/modules/es.symbol.description")},function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"h",(function(){return o})),n.d(t,"g",(function(){return i})),n.d(t,"d",(function(){return c})),n.d(t,"f",(function(){return a})),n.d(t,"e",(function(){return u})),n.d(t,"c",(function(){return s})),n.d(t,"b",(function(){return f}));n(5),n(9),n(2);var r=Symbol.for("NewableSyncClient"),o=Symbol.for("Sync"),i=Symbol.for("SyncProvider"),c=Symbol.for("SyncCache"),a=Symbol.for("SyncMapProvider"),u=Symbol.for("SyncMapItemProvider"),s=Symbol.for("NewableSyncMap"),f=Symbol.for("NewableSyncMapItem")},function(e,t,n){"use strict";n.d(t,"d",(function(){return r})),n.d(t,"f",(function(){return o})),n.d(t,"b",(function(){return i})),n.d(t,"e",(function(){return c})),n.d(t,"c",(function(){return a})),n.d(t,"a",(function(){return u}));n(5),n(9),n(2);var r=Symbol.for("SyncAdapter"),o=Symbol.for("TwilsockAdapter"),i=Symbol.for("HttpAdapter"),c="TelemetryService",a="QueueStatsService",u="ConfigurationService"},function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return o})),n.d(t,"d",(function(){return i})),n.d(t,"c",(function(){return c})),n.d(t,"e",(function(){return a}));n(5),n(9),n(2);var r=Symbol.for("TelemetryClient"),o=Symbol.for("TelemetryClientFactory"),i=Symbol.for("TelemetryEventGroup"),c=Symbol.for("TelemetryEventGroupFactory"),a=Symbol.for("TelemetryProcessor")},function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),n.d(t,"c",(function(){return o.c})),n.d(t,"b",(function(){return o.b})),n.d(t,"d",(function(){return o.d})),function(e){e.TokenExpired="tokenExpired",e.TokenAboutToExpire="tokenAboutToExpire",e.ConnectionLost="connectionLost",e.ConnectionRestored="connectionRestored",e.Disconnected="disconnected"}(r||(r={}));var o=n(42)},function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"f",(function(){return o})),n.d(t,"e",(function(){return i})),n.d(t,"a",(function(){return c})),n.d(t,"d",(function(){return a})),n.d(t,"c",(function(){return u}));n(5),n(9),n(2);var r=Symbol.for("loggerFactory"),o=Symbol.for("NewableLogger"),i=Symbol.for("loglevelFactory"),c=Symbol.for("loggerDefaultPlugins"),a=Symbol.for("LoggerSettings"),u=Symbol.for("LoggerInstances")},function(e,t){e.exports=require("core-js/modules/es.array.iterator")},function(e,t){e.exports=require("core-js/modules/es.string.iterator")},function(e,t){e.exports=require("core-js/modules/web.dom-collections.iterator")},function(e,t,n){"use strict";n.d(t,"d",(function(){return r})),n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return i})),n.d(t,"f",(function(){return c})),n.d(t,"e",(function(){return a})),n.d(t,"c",(function(){return u}));n(5),n(9),n(2);var r=Symbol.for("Authenticator"),o=Symbol.for("AuthenticatorDataContainer"),i=Symbol.for("AuthenticatorFactory"),c=Symbol.for("TwilioIdpUrl"),a=Symbol.for("twilioIdpUrlMockOptions"),u=Symbol.for("authenticatorMockOptions")},function(e,t){e.exports=require("core-js/modules/es.array.concat")},function(e,t,n){"use strict";var r=n(39);n.d(t,"a",(function(){return r.a})),n.d(t,"b",(function(){return r.b}))},function(e,t,n){"use strict";n.d(t,"d",(function(){return r})),n.d(t,"e",(function(){return o})),n.d(t,"c",(function(){return i})),n.d(t,"a",(function(){return c})),n.d(t,"b",(function(){return a}));n(5),n(9),n(2);var r=Symbol.for("RealtimeStats"),o=Symbol.for("TasksByTimeFactory"),i=Symbol.for("QueueStatsProvider"),c=Symbol.for("NewableQueueStats"),a=Symbol.for("NewableTasksByTime")},function(e,t){e.exports=require("core-js/modules/es.symbol.iterator")},function(e,t,n){"use strict";n.d(t,"c",(function(){return i})),n.d(t,"d",(function(){return c})),n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return u}));n(5),n(9),n(22),n(15),n(95),n(96),n(2),n(16),n(86),n(17);var r=n(1);function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e,t){if("object"!==o(e)||null===e||Array.isArray(e))throw new r.b(r.a.InvalidParams,"".concat(t,", expected an object"))}function c(e,t){if("string"!=typeof e)throw new r.b(r.a.InvalidParams,"".concat(t,", expected a string"))}function a(e,t){if(c(e,t),""===e.trim())throw new r.b(r.a.InvalidParams,"".concat(t,", expected a string which is not empty"))}function u(e,t){if(!(e in t))throw new r.b(r.a.InvalidParams,"".concat(e," is not a valid key"))}},function(e,t,n){"use strict";n.d(t,"e",(function(){return r})),n.d(t,"b",(function(){return o})),n.d(t,"d",(function(){return i})),n.d(t,"a",(function(){return c})),n.d(t,"c",(function(){return a})),n.d(t,"g",(function(){return u})),n.d(t,"f",(function(){return s}));n(5),n(9),n(2);var r=Symbol.for("EnvironmentConfig"),o=Symbol.for("AccountConfig"),i=(Symbol.for("AccountConfigData"),Symbol.for("ConfigDataContainer")),c=Symbol.for("AccountConfigProvider"),a=Symbol.for("AccountConfigUpdater"),u=Symbol.for("PublicConfigProvider"),s=Symbol.for("PublicConfigMockOptions")},function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"c",(function(){return o}));var r,o,i=n(59);n.d(t,"a",(function(){return i.SyncClient})),function(e){e.ConnectionStateChanged="connectionStateChanged"}(r||(r={})),function(e){e.Connected="connected",e.Error="error",e.Disconnected="disconnected",e.Denied="denied"}(o||(o={}))},function(e,t){e.exports=require("core-js/modules/es.array.for-each")},function(e,t){e.exports=require("core-js/modules/web.dom-collections.for-each")},function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return o})),n.d(t,"c",(function(){return i}));n(5),n(9),n(2);var r=Symbol.for("NewableTwilsockClient"),o=Symbol.for("ProductID"),i=Symbol.for("Twilsock")},function(e,t,n){"use strict";var r,o,i,c;n.d(t,"b",(function(){return r})),n.d(t,"c",(function(){return o})),n.d(t,"d",(function(){return i})),n.d(t,"a",(function(){return c})),n.d(t,"e",(function(){return a.a})),function(e){e.Default="default"}(r||(r={})),function(e){e.ClientInitialized="client_initialized",e.ClientDestroyed="client_destroyed"}(o||(o={})),function(e){e.Client="Client"}(i||(i={})),function(e){e.TwilioChat="twilio_chat",e.TwilioSync="twilio_sync",e.TwilioClient="twilio_client",e.Twilsock="twilsock"}(c||(c={}));var a=n(56)},function(e,t){e.exports=require("core-js/modules/es.regexp.to-string")},function(e,t){e.exports=require("core-js/modules/es.object.keys")},function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"c",(function(){return r.b})),n.d(t,"b",(function(){return r.a})),n.d(t,"d",(function(){return r.d}));n(35);var r=n(12);function o(e,t){var n=e.get(r.b);return n.name=t,n}},function(e,t,n){"use strict";n.d(t,"b",(function(){return v})),n.d(t,"d",(function(){return b})),n.d(t,"c",(function(){return h})),n.d(t,"a",(function(){return m}));n(5),n(9),n(22),n(26),n(15),n(2),n(16),n(27),n(17);var r=n(83),o=n.n(r),i=n(84),c=n.n(i),a=n(89),u=n.n(a),s=n(90),f=n.n(s);function l(e){return(l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var p=function e(t,n){var r=[];return t.forEach((function(t){var o;o=Array.isArray(t)?e(t,n):"object"===l(t)?d(t,n):t,r.push(o)})),r},d=function e(t,n){return f()(t,(function(t,r,o){Array.isArray(r)?t["".concat(n(o))]=p(r,n):r instanceof Object&&!(r instanceof Date)?t["".concat(n(o))]=e(r,n):t["".concat(n(o))]=r}),{})},v=function(e){return d(e,(function(e){return o()(e)}))},y=function(e,t){return u()(e,(function(e,n){return t(n)}))},b=function(e){return y(e,(function(e){return c()(e)}))},h=function(e){return y(e,(function(e){return o()(e)}))},m=function(e){return d(e,(function(e){return c()(e)}))}},function(e,t){e.exports=require("core-js/modules/es.object.get-own-property-descriptor")},function(e,t){e.exports=require("core-js/modules/es.function.name")},function(e,t,n){"use strict";n.d(t,"a",(function(){return m}));n(19),n(26),n(63),n(64),n(41),n(31),n(27);var r,o,i,c,a,u,s=n(0),f=n(57);function l(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var p,d,v,y,b,h,m=(r=Object(s.injectable)(),o=Object(s.inject)(f.a),r((u=function(){function e(){var t,n,r,o;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),t=this,n="emitter",o=this,(r=a)&&Object.defineProperty(t,n,{enumerable:r.enumerable,configurable:r.configurable,writable:r.writable,value:r.initializer?r.initializer.call(o):void 0})}var t,n,r;return t=e,(n=[{key:"on",value:function(e,t){return this.emitter.on(e,t),this}},{key:"removeAllListeners",value:function(){return this.emitter.removeAllListeners(),this}},{key:"removeListener",value:function(e,t){return this.emitter.removeListener(e,t),this}},{key:"emit",value:function(e){for(var t,n=arguments.length,r=new Array(n>1?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];return(t=this.emitter).emit.apply(t,[e].concat(r))}},{key:"proxyEvent",value:function(e,t,n){var r=this;e.on(t,(function(){for(var e=arguments.length,t=new Array(e),o=0;o<e;o++)t[o]=arguments[o];r.emit.apply(r,[n].concat(t))}))}}])&&l(t.prototype,n),r&&l(t,r),e}(),p=(c=u).prototype,d="emitter",v=[o],y={configurable:!0,enumerable:!0,writable:!0,initializer:null},h={},Object.keys(y).forEach((function(e){h[e]=y[e]})),h.enumerable=!!h.enumerable,h.configurable=!!h.configurable,("value"in h||h.initializer)&&(h.writable=!0),h=v.slice().reverse().reduce((function(e,t){return t(p,d,e)||e}),h),b&&void 0!==h.initializer&&(h.value=h.initializer?h.initializer.call(b):void 0,h.initializer=void 0),void 0===h.initializer&&(Object.defineProperty(p,d,h),h=null),a=h,i=c))||i)},function(e,t,n){"use strict";var r=n(18);n.d(t,"b",(function(){return r.d})),n.d(t,"a",(function(){return r.b})),n.d(t,"c",(function(){return r.f}))},function(e,t){e.exports=require("core-js/modules/es.object.get-prototype-of")},function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return o}));n(5),n(9),n(2);var r=Symbol.for("Session"),o=Symbol.for("SessionSettings")},function(e,t){e.exports=require("core-js/modules/es.reflect.construct")},function(e,t){e.exports=require("core-js/modules/es.array.slice")},function(e,t,n){"use strict";n.d(t,"c",(function(){return r})),n.d(t,"b",(function(){return o})),n.d(t,"d",(function(){return i})),n.d(t,"a",(function(){return c}));n(5),n(9),n(2);var r=Symbol.for("Client"),o=Symbol.for("ClientProvider"),i=Symbol.for("ClientSettings"),c=Symbol.for("ClientMockOptions")},function(e,t,n){"use strict";var r,o,i;n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return o})),n.d(t,"c",(function(){return i})),function(e){e.Client="flex:Client",e.Session="flex:Session",e.Twilsock="flex:Twilsock",e.Auth="flex:Auth",e.Config="flex:Config",e.Sync="flex:Sync",e.SyncAdapter="flex:SyncAdapter",e.QueueStats="flex:QueueStats"}(r||(r={})),function(e){e.TwilioChat="twilio-chat",e.TwilioSync="twilio-sync",e.Twilsock="twilsock"}(o||(o={})),function(e){e.TelemetryClient="TelemetryClient",e.TelemetryProcessor="TelemetryProcessor",e.TelemetrySdkClient="TelemetrySdkClient"}(i||(i={}))},function(e,t){e.exports=require("core-js/modules/es.map")},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));n(5),n(47),n(26),n(34),n(48),n(31),n(27);var r=n(33),o=n(62);function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function c(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e,t,n,a){return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){c(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({subscribe:n,unsubscribe:a},function(e,t){var n=t.mapKeysToCamelCase?Object(r.b)(e):e;return t.dateFields&&t.dateFields.forEach((function(e){if(Object(o.a)(n,e)){var t=n[e];n[e]=t?new Date(t):void 0}})),n}(e,t))}},function(e,t){e.exports=require("core-js/modules/es.regexp.exec")},function(e,t){e.exports=require("core-js/modules/es.array.filter")},function(e,t){e.exports=require("core-js/modules/es.object.get-own-property-descriptors")},function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e.Destroyed="destroyed"}(r||(r={}))},function(e,t,n){var r,o;function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}n(5),n(9),n(22),n(53),n(15),n(41),n(35),n(2),n(46),n(16),n(17),function(c,a){"use strict";void 0===(o="function"==typeof(r=function(){var e=function(){},t="undefined"!==("undefined"==typeof window?"undefined":i(window))&&"undefined"!==i(window.navigator)&&/Trident\/|MSIE /.test(window.navigator.userAgent),n=["trace","debug","info","warn","error"];function r(e,t){var n=e[t];if("function"==typeof n.bind)return n.bind(e);try{return Function.prototype.bind.call(n,e)}catch(t){return function(){return Function.prototype.apply.apply(n,[e,arguments])}}}function o(){console.log&&(console.log.apply?console.log.apply(console,arguments):Function.prototype.apply.apply(console.log,[console,arguments])),console.trace&&console.trace()}function c(n){return"debug"===n&&(n="log"),"undefined"!==("undefined"==typeof console?"undefined":i(console))&&("trace"===n&&t?o:void 0!==console[n]?r(console,n):void 0!==console.log?r(console,"log"):e)}function a(t,r){for(var o=0;o<n.length;o++){var i=n[o];this[i]=o<t?e:this.methodFactory(i,t,r)}this.log=this.debug}function u(e,t,n){return function(){"undefined"!==("undefined"==typeof console?"undefined":i(console))&&(a.call(this,t,n),this[e].apply(this,arguments))}}function s(e,t,n){return c(e)||u.apply(this,arguments)}function f(e,t,r){var o,c=this,u="loglevel";function f(){var e;if("undefined"!==("undefined"==typeof window?"undefined":i(window))){try{e=window.localStorage[u]}catch(e){}if("undefined"===i(e))try{var t=window.document.cookie,n=t.indexOf(encodeURIComponent(u)+"=");-1!==n&&(e=/^([^;]+)/.exec(t.slice(n))[1])}catch(e){}return void 0===c.levels[e]&&(e=void 0),e}}e&&(u+=":"+e),c.name=e,c.levels={TRACE:0,DEBUG:1,INFO:2,WARN:3,ERROR:4,SILENT:5},c.methodFactory=r||s,c.getLevel=function(){return o},c.setLevel=function(t,r){if("string"==typeof t&&void 0!==c.levels[t.toUpperCase()]&&(t=c.levels[t.toUpperCase()]),!("number"==typeof t&&t>=0&&t<=c.levels.SILENT))throw"log.setLevel() called with invalid level: "+t;if(o=t,!1!==r&&function(e){var t=(n[e]||"silent").toUpperCase();if("undefined"!==("undefined"==typeof window?"undefined":i(window))){try{return void(window.localStorage[u]=t)}catch(e){}try{window.document.cookie=encodeURIComponent(u)+"="+t+";"}catch(e){}}}(t),a.call(c,t,e),"undefined"===("undefined"==typeof console?"undefined":i(console))&&t<c.levels.SILENT)return"No console available for logging"},c.setDefaultLevel=function(e){f()||c.setLevel(e,!1)},c.enableAll=function(e){c.setLevel(c.levels.TRACE,e)},c.disableAll=function(e){c.setLevel(c.levels.SILENT,e)};var l=f();null==l&&(l=null==t?"WARN":t),c.setLevel(l,!1)}var l=new f,p={};l.getLogger=function(e){if("string"!=typeof e||""===e)throw new TypeError("You must supply a name when creating a logger.");var t=p[e];return t||(t=p[e]=new f(e,l.getLevel(),l.methodFactory)),t};var d="undefined"!==("undefined"==typeof window?"undefined":i(window))?window.log:void 0;return l.noConflict=function(){return"undefined"!==("undefined"==typeof window?"undefined":i(window))&&window.log===l&&(window.log=d),l},l.getLoggers=function(){return p},l})?r.call(t,n,t,e):r)||(e.exports=o)}()},function(e,t){e.exports=require("events")},function(e,t,n){"use strict";n.d(t,"d",(function(){return o.g})),n.d(t,"a",(function(){return i.a})),n.d(t,"b",(function(){return c.a})),n.d(t,"c",(function(){return r}));var r,o=n(10),i=n(66),c=n(49);!function(e){e.Flex="flex",e.FlexInsights="flex_insights"}(r||(r={}))},function(e,t){e.exports=require("core-js/modules/es.array.index-of")},function(e,t){e.exports=require("core-js/modules/es.array.includes")},function(e,t){e.exports=require("core-js/modules/es.string.includes")},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));n(5),n(9),n(2);var r=Symbol.for("TelemetrySdkClient")},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));n(5),n(9),n(2);var r=Symbol.for("eventEmitter")},function(e,t){e.exports=require("loglevel")},function(e,t){e.exports=require("twilio-sync")},function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return o.d})),function(e){e.Today="tasks_today",e.ThirtyMinutes="tasks_thirty_minutes"}(r||(r={}));var o=n(21)},function(e,t){e.exports=require("lodash.clonedeep")},function(e,t,n){"use strict";function r(e,t){return Object.prototype.hasOwnProperty.call(e,t)}n.d(t,"a",(function(){return r}))},function(e,t){e.exports=require("core-js/modules/es.array.reduce")},function(e,t){e.exports=require("core-js/modules/es.array.reverse")},function(e,t){e.exports=require("core-js/modules/es.array.from")},function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e.OpenExisting="open_existing",e.OpenOrCreate="open_or_create",e.CreateNew="create_new"}(r||(r={}))},function(e,t){e.exports=require("core-js/modules/es.string.replace")},function(e,t){e.exports=require("core-js/modules/es.array.map")},function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e.TokenExpired="tokenExpired",e.TokenAboutToExpire="tokenAboutToExpire",e.StateChanged="stateChanged",e.ConnectionError="connectionError",e.Connected="connected",e.Disconnected="disconnected",e.TokenUpdated="tokenUpdated"}(r||(r={}))},function(e){e.exports=JSON.parse('{"a":"0.4.3"}')},function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(61),o=n.n(r),i={autoUpdateToken:!0};function c(){return o()(i)}},function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r,o=n(0),i=n(20),c=n(3);function a(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var u=Object(o.injectable)()(r=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._session=t,this._logger=n}var t,n,r;return e=Object(o.inject)(c.e)(e,void 0,1)||e,e=Object(o.inject)(i.b)(e,void 0,0)||e,t=e,(n=[{key:"session",get:function(){return this._session}},{key:"logger",get:function(){return this._logger}},{key:"region",get:function(){return this._region},set:function(e){this._region=e}},{key:"appName",get:function(){return this._appName},set:function(e){this._appName=e}},{key:"appVersion",get:function(){return this._appVersion},set:function(e){this._appVersion=e}}])&&a(t.prototype,n),r&&a(t,r),e}())||r},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r,o=n(0),i=n(1);function c(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var a=Object(o.injectable)()(r=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,(n=[{key:"get",value:function(){if(!this.data)throw new i.c("Config data hasn't been fetched");return this.data}},{key:"set",value:function(e){this.data=e}}])&&c(t.prototype,n),r&&c(t,r),e}())||r},function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));n(54),n(63),n(31),n(55);var r,o=n(50),i=n.n(o),c=n(14),a=n(23),u=n(43);function s(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var f=(s(r={},u.b.TwilioChat,i.a),s(r,u.b.TwilioSync,i.a),s(r,u.b.Twilsock,i.a),r),l=function(e){return function(t){Object(a.d)(t,"name");var n=e.get(c.c),r=n.get(t);if(r)return r;var o,i=e.get(c.d).level,u=e.get(c.e),s=e.get(c.a);return o=Object.keys(f).includes(t)?function(e){return f[e].getLogger(e)}(t):u(t),o=s.reduce((function(e,t){return t(e)}),o),(r=new(e.get(c.f))(o)).setLevel(i),n.set(t,r),r}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(61),o=n.n(r),i={level:"ERROR"};function c(){return o()(i)}},function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));n(5),n(9),n(22),n(65),n(54),n(15),n(41),n(35),n(2),n(85),n(4),n(46),n(30),n(55),n(16),n(104),n(17),n(7);var r,o=n(0),i=n(3),c=n(52),a=n(1);function u(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var c,a=e[Symbol.iterator]();!(r=(c=a.next()).done)&&(n.push(c.value),!t||n.length!==t);r=!0);}catch(e){o=!0,i=e}finally{try{r||null==a.return||a.return()}finally{if(o)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return s(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return s(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function s(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function f(e,t,n,r,o,i,c){try{var a=e[i](c),u=a.value}catch(e){return void n(e)}a.done?t(u):Promise.resolve(u).then(r,o)}function l(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function c(e){f(i,r,o,c,a,"next",e)}function a(e){f(i,r,o,c,a,"throw",e)}c(void 0)}))}}function p(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var d=Object(o.injectable)()(r=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.logger=n(i.b.SyncAdapter),this.syncProvider=t}var t,n,r,s,f;return e=Object(o.inject)(i.d)(e,void 0,1)||e,e=Object(o.inject)(c.d)(e,void 0,0)||e,t=e,(n=[{key:"getSyncObjectByPath",value:(f=l(regeneratorRuntime.mark((function e(t){var n,r,o,i,s,f,l;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.logger.trace("getSyncObjectByPath",t),n=t.split("/"),(r=u(n,6))[0],o=r[1],i=r[2],s=r[3],r[4],f=r[5],l=o,Object.values(c.c).includes(l)){e.next=5;break}throw new a.c("Unknown product id: ".concat(o));case 5:if("Documents"!==i){e.next=7;break}return e.abrupt("return",this.getDocument(l,s));case 7:if("Maps"!==i){e.next=11;break}if(!f){e.next=10;break}return e.abrupt("return",this.getMapItem(l,s,f));case 10:return e.abrupt("return",this.getMap(l,s));case 11:if("Lists"!==i){e.next=13;break}return e.abrupt("return",this.getList(l,s));case 13:throw new a.c("Invalid Sync Object URL");case 14:case"end":return e.stop()}}),e,this)}))),function(e){return f.apply(this,arguments)})},{key:"getDocument",value:function(e,t){throw this.logger.trace("getDocument",e,t),new Error("Not implemented.")}},{key:"getList",value:function(e,t){throw this.logger.trace("getList",e,t),new Error("Not implemented.")}},{key:"getMap",value:function(e,t){throw this.logger.trace("getMap",e,t),new Error("Not implemented.")}},{key:"getMapItem",value:(s=l(regeneratorRuntime.mark((function e(t,n,r){var o,i,c;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.logger.trace("getMapItem",t,n,r),e.next=3,this.syncProvider(t);case 3:return o=e.sent,e.next=6,o.getMapById(n);case 6:return i=e.sent,e.next=9,i.get(r);case 9:return c=e.sent,e.abrupt("return",c);case 11:case"end":return e.stop()}}),e,this)}))),function(e,t,n){return s.apply(this,arguments)})}])&&p(t.prototype,n),r&&p(t,r),e}())||r},function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));n(2),n(4),n(7);var r,o=n(0),i=n(8);function c(e,t,n,r,o,i,c){try{var a=e[i](c),u=a.value}catch(e){return void n(e)}a.done?t(u):Promise.resolve(u).then(r,o)}function a(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var u=Object(o.injectable)()(r=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.twilsock=t}var t,n,r,u,s;return e=Object(o.inject)(i.b)(e,void 0,0)||e,t=e,(n=[{key:"post",value:(u=regeneratorRuntime.mark((function e(t,n){var r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.twilsock.post(t,{},n);case 2:return r=e.sent,e.abrupt("return",r);case 4:case"end":return e.stop()}}),e,this)})),s=function(){var e=this,t=arguments;return new Promise((function(n,r){var o=u.apply(e,t);function i(e){c(o,n,r,i,a,"next",e)}function a(e){c(o,n,r,i,a,"throw",e)}i(void 0)}))},function(e,t){return s.apply(this,arguments)})}])&&a(t.prototype,n),r&&a(t,r),e}())||r},function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));n(2),n(4),n(46),n(67),n(105),n(7);var r,o=n(0),i=n(1),c=n(20),a=n(6),u=n(33);function s(e,t,n,r,o,i,c){try{var a=e[i](c),u=a.value}catch(e){return void n(e)}a.done?t(u):Promise.resolve(u).then(r,o)}function f(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var l=Object(o.injectable)()(r=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.session=t,this.envConfig=n}var t,n,r,l,p;return e=Object(o.inject)(a.d)(e,void 0,1)||e,e=Object(o.inject)(c.a)(e,void 0,0)||e,t=e,(n=[{key:"get",value:function(e,t){return this.performNetworkCall(e,"GET",t)}},{key:"post",value:function(e,t,n){return this.performNetworkCall(e,"POST",t,n)}},{key:"put",value:function(e,t,n){return this.performNetworkCall(e,"PUT",t,n)}},{key:"delete",value:function(e,t){return this.performNetworkCall(e,"DELETE",t)}},{key:"getRequestData",value:function(e,t,n){var r;return"jwe"===t&&(r=new Headers({Authorization:"Basic ".concat(btoa("token:".concat(this.session.token)),")"),"Content-Type":"application/json"})),{headers:r,method:e,body:JSON.stringify(n)}}},{key:"getEnvironmentSpecificUrl",value:function(e){var t="",n=this.envConfig.region||"";return n.startsWith("dev-")?t=".dev":n.startsWith("stage-")&&(t=".stage"),e.replace("[environment]",t)}},{key:"mapBody",value:function(e){return e?Object(u.d)(e):e}},{key:"performNetworkCall",value:(l=regeneratorRuntime.mark((function e(t,n,r,o){var c,a,s;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c=this.getEnvironmentSpecificUrl(t),e.next=3,fetch(c,this.getRequestData(n,r,this.mapBody(o)));case 3:if((a=e.sent).ok){e.next=7;break}return e.next=7,Object(i.e)(a);case 7:return e.next=9,a.json();case 9:return s=e.sent,e.abrupt("return",Object(u.c)(s));case 11:case"end":return e.stop()}}),e,this)})),p=function(){var e=this,t=arguments;return new Promise((function(n,r){var o=l.apply(e,t);function i(e){s(o,n,r,i,c,"next",e)}function c(e){s(o,n,r,i,c,"throw",e)}i(void 0)}))},function(e,t,n,r){return p.apply(this,arguments)})}])&&f(t.prototype,n),r&&f(t,r),e}())||r},function(e,t,n){"use strict";n.d(t,"a",(function(){return b}));n(19),n(2),n(4),n(7);var r,o=n(0),i=n(1),c=n(11),a=(n(5),n(9),n(22),n(26),n(65),n(15),n(41),n(35),n(102),n(103),n(46),n(30),n(16),n(27),n(17),n(62));function u(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var c,a=e[Symbol.iterator]();!(r=(c=a.next()).done)&&(n.push(c.value),!t||n.length!==t);r=!0);}catch(e){o=!0,i=e}finally{try{r||null==a.return||a.return()}finally{if(o)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return s(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return s(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function s(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function f(e){var t=/^\d{4}-\d{1,2}-\d{1,2}/,n=new RegExp("date","i"),r={};return Object.entries(e).forEach((function(o){var i=u(o,2),c=i[0],s=i[1];Object(a.a)(e,c)&&n.test(c)&&t.test(s)?r[c]=new Date(s):r[c]=s})),r}function l(e,t,n,r,o,i,c){try{var a=e[i](c),u=a.value}catch(e){return void n(e)}a.done?t(u):Promise.resolve(u).then(r,o)}function p(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function c(e){l(i,r,o,c,a,"next",e)}function a(e){l(i,r,o,c,a,"throw",e)}c(void 0)}))}}function d(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var v=Object(o.injectable)()(r=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.httpAdapter=t}var t,n,r,a,u,s;return e=Object(o.inject)(c.b)(e,void 0,0)||e,t=e,(n=[{key:"fetchConfiguration",value:(s=p(regeneratorRuntime.mark((function e(){var t,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.httpAdapter.get("https://flex-api[environment].twilio.com/v1/Configuration","jwe");case 2:return t=e.sent,n=f(t),e.abrupt("return",n);case 5:case"end":return e.stop()}}),e,this)}))),function(){return s.apply(this,arguments)})},{key:"fetchPublicConfiguration",value:(u=p(regeneratorRuntime.mark((function e(t,n){var r,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=t){e.next=2;break}throw new i.b(i.a.InvalidParams,"Required parameter queryParamName was null or undefined.");case 2:if(null!=n){e.next=4;break}throw new i.b(i.a.InvalidParams,"Required parameter queryParamValue was null or undefined.");case 4:return e.next=6,this.httpAdapter.get("https://flex-api[environment].twilio.com/v1/Configuration/Public?".concat(encodeURIComponent(String(t)),"=").concat(encodeURIComponent(String(n))),void 0);case 6:return r=e.sent,o=f(r),e.abrupt("return",o);case 9:case"end":return e.stop()}}),e,this)}))),function(e,t){return u.apply(this,arguments)})},{key:"updateConfiguration",value:(a=p(regeneratorRuntime.mark((function e(t){var n,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=t){e.next=2;break}throw new i.b(i.a.InvalidParams,"Required parameter accountConfigData was null or undefined.");case 2:return e.next=4,this.httpAdapter.post("https://flex-api[environment].twilio.com/v1/Configuration","jwe",t);case 4:return n=e.sent,r=f(n),e.abrupt("return",r);case 7:case"end":return e.stop()}}),e,this)}))),function(e){return a.apply(this,arguments)})}])&&d(t.prototype,n),r&&d(t,r),e}())||r;function y(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var b=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,r=[{key:"with",value:function(e){e.bind("ConfigurationService").to(v).inSingletonScope()}}],(n=null)&&y(t.prototype,n),r&&y(t,r),e}()},function(e,t,n){"use strict";n.d(t,"a",(function(){return h}));n(2),n(4),n(7);var r=n(59),o=n(13),i=n(20),c=(n(38),n(88)),a=n.n(c),u=n(1),s=n(23);function f(e,t){void 0!==t&&Object(s.c)(t,"userSettings");a()(e,t,(function(e,t,n,r,o){var i=Object.prototype.hasOwnProperty.call(r,n),c=Object.prototype.hasOwnProperty.call(Object.getPrototypeOf(r),n);if(!i&&!c)throw new u.b(u.a.InvalidParams,"".concat(n," is not a valid property"))}))}var l=n(29),p=n(3);function d(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function v(e,t,n,r,o,i,c){try{var a=e[i](c),u=a.value}catch(e){return void n(e)}a.done?t(u):Promise.resolve(u).then(r,o)}function y(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function c(e){v(i,r,o,c,a,"next",e)}function a(e){v(i,r,o,c,a,"throw",e)}c(void 0)}))}}var b=function(){var e=y(regeneratorRuntime.mark((function e(t,n,r){var o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,o=n.createEventGroup(l.b.Default),e.next=4,o.addEvents({eventName:l.c.ClientInitialized,eventSource:l.d.Client,durationMs:r});case 4:e.next=9;break;case 6:e.prev=6,e.t0=e.catch(0),t.error("Failed to send client init event",e.t0);case 9:case"end":return e.stop()}}),e,null,[[0,6]])})));return function(t,n,r){return e.apply(this,arguments)}}();function h(e,t,n){return m.apply(this,arguments)}function m(){return(m=y(regeneratorRuntime.mark((function e(t,n,c){var a,v,y,h,m,g,w,k,S;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=Date.now(),Object(s.b)(n,"token"),v=t.get(o.d),y=t.get(p.d),h=y(p.b.Client),f(v,c),m=t.get(o.c),g=t.get(i.a),e.prev=8,e.next=11,g.init(n);case 11:e.next=20;break;case 13:if(e.prev=13,e.t0=e.catch(8),2002!==e.t0.code&&20003!==e.t0.code){e.next=19;break}throw new u.b(u.a.Forbidden,"Insufficient permissions");case 19:Object(u.d)(e.t0);case 20:return e.prev=20,k=t.get(l.e),e.next=24,k.setSessionData({dependencies:(w={},d(w,l.a.TwilioSync,r.SyncClient.version),d(w,l.a.Twilsock,"default"),w)});case 24:return S=Date.now()-a,e.next=27,b(h,k,S);case 27:e.next=32;break;case 29:e.prev=29,e.t1=e.catch(20),h.error("Failed to set session data for telemetry",e.t1);case 32:return e.abrupt("return",m);case 33:case"end":return e.stop()}}),e,null,[[8,13],[20,29]])})))).apply(this,arguments)}},function(e,t,n){"use strict";n.d(t,"a",(function(){return f}));n(2),n(4),n(7);var r,o=n(0),i=n(11);function c(e,t,n,r,o,i,c){try{var a=e[i](c),u=a.value}catch(e){return void n(e)}a.done?t(u):Promise.resolve(u).then(r,o)}function a(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var u=Object(o.injectable)()(r=function(){function e(t){var n,r,o;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),o="http://flex-sdk.twilio.com/v1",(r="basePath")in(n=this)?Object.defineProperty(n,r,{value:o,enumerable:!0,configurable:!0,writable:!0}):n[r]=o,this.twilsockAdapter=t}var t,n,r,u,s;return e=Object(o.inject)(i.f)(e,void 0,0)||e,t=e,(n=[{key:"postTelemetryEvents",value:(u=regeneratorRuntime.mark((function e(t){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=t){e.next=2;break}throw new Error("Required parameter events was null or undefined when calling postTelemetryEvents.");case 2:return e.next=4,this.twilsockAdapter.post("".concat(this.basePath,"/Telemetry/Events"),t);case 4:return n=e.sent,e.abrupt("return",n);case 6:case"end":return e.stop()}}),e,this)})),s=function(){var e=this,t=arguments;return new Promise((function(n,r){var o=u.apply(e,t);function i(e){c(o,n,r,i,a,"next",e)}function a(e){c(o,n,r,i,a,"throw",e)}i(void 0)}))},function(e){return s.apply(this,arguments)})}])&&a(t.prototype,n),r&&a(t,r),e}())||r;function s(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var f=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,r=[{key:"with",value:function(e){e.bind("TelemetryService").to(u).inSingletonScope()}}],(n=null)&&s(t.prototype,n),r&&s(t,r),e}()},function(e,t,n){"use strict";n.d(t,"a",(function(){return p}));n(19),n(2),n(4),n(7);var r,o=n(0),i=n(1),c=n(11);function a(e,t,n,r,o,i,c){try{var a=e[i](c),u=a.value}catch(e){return void n(e)}a.done?t(u):Promise.resolve(u).then(r,o)}function u(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function c(e){a(i,r,o,c,u,"next",e)}function u(e){a(i,r,o,c,u,"throw",e)}c(void 0)}))}}function s(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var f=Object(o.injectable)()(r=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.syncAdapter=t}var t,n,r,a,f,l,p;return e=Object(o.inject)(c.d)(e,void 0,0)||e,t=e,(n=[{key:"getCurrentTasksStats",value:(p=u(regeneratorRuntime.mark((function e(t){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=t){e.next=2;break}throw new i.b(i.a.InvalidParams,"Required parameter queueSid was null or undefined.");case 2:return e.next=4,this.syncAdapter.getSyncObjectByPath("/flex_insights/Maps/".concat(encodeURIComponent(String(t)),".realtime_statistics.v1/Items/tasks_now"));case 4:return n=e.sent,e.abrupt("return",n);case 6:case"end":return e.stop()}}),e,this)}))),function(e){return p.apply(this,arguments)})},{key:"getHistoricalStats",value:(l=u(regeneratorRuntime.mark((function e(t,n){var r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=t){e.next=2;break}throw new i.b(i.a.InvalidParams,"Required parameter queueSid was null or undefined.");case 2:if(null!=n){e.next=4;break}throw new i.b(i.a.InvalidParams,"Required parameter timeSpanBucketKey was null or undefined.");case 4:return e.next=6,this.syncAdapter.getSyncObjectByPath("/flex_insights/Maps/".concat(encodeURIComponent(String(t)),".realtime_statistics.v1/Items/").concat(encodeURIComponent(String(n))));case 6:return r=e.sent,e.abrupt("return",r);case 8:case"end":return e.stop()}}),e,this)}))),function(e,t){return l.apply(this,arguments)})},{key:"getMetadata",value:(f=u(regeneratorRuntime.mark((function e(t){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=t){e.next=2;break}throw new i.b(i.a.InvalidParams,"Required parameter queueSid was null or undefined.");case 2:return e.next=4,this.syncAdapter.getSyncObjectByPath("/flex_insights/Maps/".concat(encodeURIComponent(String(t)),".realtime_statistics.v1/Items/metadata"));case 4:return n=e.sent,e.abrupt("return",n);case 6:case"end":return e.stop()}}),e,this)}))),function(e){return f.apply(this,arguments)})},{key:"getWorkerStats",value:(a=u(regeneratorRuntime.mark((function e(t){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=t){e.next=2;break}throw new i.b(i.a.InvalidParams,"Required parameter queueSid was null or undefined.");case 2:return e.next=4,this.syncAdapter.getSyncObjectByPath("/flex_insights/Maps/".concat(encodeURIComponent(String(t)),".realtime_statistics.v1/Items/worker_activities_statistics"));case 4:return n=e.sent,e.abrupt("return",n);case 6:case"end":return e.stop()}}),e,this)}))),function(e){return a.apply(this,arguments)})}])&&s(t.prototype,n),r&&s(t,r),e}())||r;function l(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var p=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,r=[{key:"with",value:function(e){e.bind("QueueStatsService").to(f).inSingletonScope()}}],(n=null)&&l(t.prototype,n),r&&l(t,r),e}()},function(e,t){e.exports=require("lodash.camelcase")},function(e,t){e.exports=require("lodash.snakecase")},function(e,t){e.exports=require("core-js/modules/es.object.values")},function(e,t){e.exports=require("core-js/modules/es.string.trim")},function(e,t){e.exports=require("twilsock")},function(e,t){e.exports=require("lodash.mergewith")},function(e,t){e.exports=require("lodash.mapkeys")},function(e,t){e.exports=require("lodash.transform")},function(e,t,n){"use strict";n.d(t,"a",(function(){return er}));n(92);var r,o=n(0),i=n(18),c=(n(19),n(2),n(4),n(7),n(1)),a=n(23),u=n(3),s=n(6);n(46),n(67);function f(e){var t,n={products:["flex"],resource:(t=e.redirectUrl,t.replace(/((Token|Expiration|Identity|Roles)=[^&]+[&]?)/g,"").replace(/[&?]$/,""))};return JSON.stringify(n)}function l(e,t,n,r,o,i,c){try{var a=e[i](c),u=a.value}catch(e){return void n(e)}a.done?t(u):Promise.resolve(u).then(r,o)}function p(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function c(e){l(i,r,o,c,a,"next",e)}function a(e){l(i,r,o,c,a,"throw",e)}c(void 0)}))}}function d(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var v,y=Object(o.injectable)()(r=function(){function e(t,n,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.enviromentConfig=t,this.authenticatorDataContainer=n,this.logger=r(u.b.Auth)}var t,n,r,l,v,y;return e=Object(o.inject)(u.d)(e,void 0,2)||e,e=Object(o.inject)(i.a)(e,void 0,1)||e,e=Object(o.inject)(s.d)(e,void 0,0)||e,t=e,(n=[{key:"getIdpUrl",value:(y=p(regeneratorRuntime.mark((function e(t){var n,r,o,i,u,s,l;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Object(a.b)(t.redirectUrl,"redirect url"),n=new Headers({"Content-Type":"application/json"}),r=f(t),o=this.enviromentConfig.authServiceUrl,i=this.authenticatorDataContainer.accountSid,u="".concat(o,"/").concat(i,"/authenticate"),e.next=8,fetch(u,{headers:n,method:"POST",body:r});case 8:if((s=e.sent).ok){e.next=12;break}return e.next=12,Object(c.e)(s);case 12:return e.next=14,s.json();case 14:if((l=e.sent).location){e.next=18;break}throw this.logger.error("No redirect location from /authenticate request, data: ",l),new c.c("Invalid response from /authenticate endpoint");case 18:return e.abrupt("return",l.location);case 19:case"end":return e.stop()}}),e,this)}))),function(e){return y.apply(this,arguments)})},{key:"validateToken",value:(v=p(regeneratorRuntime.mark((function e(t){var n,r,o,i,u;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Object(a.b)(t,"token"),n=new Headers({Authorization:"Basic ".concat(btoa("token:".concat(t)),")"),"Content-Type":"application/json"}),r=this.enviromentConfig.authServiceUrl,o=this.authenticatorDataContainer.accountSid,i="".concat(r,"/").concat(o,"/Tokens/validate"),e.next=7,fetch(i,{method:"POST",headers:n,body:JSON.stringify({token:t})});case 7:if((u=e.sent).ok){e.next=11;break}return e.next=11,Object(c.e)(u);case 11:return e.abrupt("return",u.json());case 12:case"end":return e.stop()}}),e,this)}))),function(e){return v.apply(this,arguments)})},{key:"refreshToken",value:(l=p(regeneratorRuntime.mark((function e(t){var n,r,o,i,u,s;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Object(a.b)(t,"token"),n=this.enviromentConfig.authServiceUrl,r=this.authenticatorDataContainer.accountSid,o="".concat(n,"/").concat(r,"/Tokens/refresh"),i=new Headers({"Content-Type":"application/json"}),e.next=7,fetch(o,{headers:i,method:"POST",body:JSON.stringify({token:t})});case 7:if((u=e.sent).ok){e.next=11;break}return e.next=11,Object(c.e)(u,"Could not refresh token");case 11:return e.next=13,u.json();case 13:return s=e.sent,e.abrupt("return",Promise.resolve(s.token));case 15:case"end":return e.stop()}}),e,this)}))),function(e){return l.apply(this,arguments)})}])&&d(t.prototype,n),r&&d(t,r),e}())||r,b=n(37);function h(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var m,g=Object(o.injectable)()(v=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,(n=[{key:"accountSid",get:function(){return this._accountSid},set:function(e){this._accountSid=e}}])&&h(t.prototype,n),r&&h(t,r),e}())||v,w=new o.ContainerModule((function(e){e(i.d).to(y),e(i.a).to(g).inSingletonScope(),e(i.b).toFactory((function(e){return function(t){return function(e,t){return e.get(i.a).accountSid=t,e.get(b.b)}(e.container,t)}})),e(i.f).toDynamicValue((function(e){return function(t){return function(e,t){var n=e.get(s.d).twilioServiceLoginUrl;return t?"".concat(n,"?localPort=").concat(t):n}(e.container,t)}}))})),k=n(39),S=n(20),j=n(8);function x(e,t,n,r,o,i,c){try{var a=e[i](c),u=a.value}catch(e){return void n(e)}a.done?t(u):Promise.resolve(u).then(r,o)}function O(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function c(e){x(i,r,o,c,a,"next",e)}function a(e){x(i,r,o,c,a,"throw",e)}c(void 0)}))}}function C(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function P(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var E,T,R,I,A,D,_,q,M,U,N,F=Object(o.injectable)()(m=function(){function e(t,n,r,o,i){var c=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),P(this,"_roles",[]),P(this,"isActive",!0),P(this,"handleTokenAboutToExpire",O(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!c.accountConfig){e.next=5;break}return e.next=3,c.autoUpdateToken();case 3:e.next=6;break;case 5:c.needsToAutoUpdateToken=!0;case 6:case"end":return e.stop()}}),e)})))),this.connection=t,this.settings=n,this.accountConfigProvider=o,this.authFactory=r,this.logger=i(u.b.Session),this.logger.debug("Session constructed")}var t,n,r,i,a,f,l;return e=Object(o.inject)(u.d)(e,void 0,4)||e,e=Object(o.inject)(s.a)(e,void 0,3)||e,e=Object(o.inject)(b.a)(e,void 0,2)||e,e=Object(o.inject)(S.b)(e,void 0,1)||e,e=Object(o.inject)(j.b)(e,void 0,0)||e,t=e,(n=[{key:"init",value:(l=O(regeneratorRuntime.mark((function e(t){var n,r,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.logger.debug("will initialize session with token: ",t),this.logger.debug("will update token: ",this.settings.autoUpdateToken),this._token=t,e.next=5,this.connection.connect(t);case 5:return this.settings.autoUpdateToken&&this.connection.on(j.a.TokenAboutToExpire,this.handleTokenAboutToExpire),e.next=8,this.accountConfigProvider();case 8:if(this.accountConfig=e.sent,n=this.accountConfig.get("accountSid"),!this.needsToAutoUpdateToken){e.next=13;break}return e.next=13,this.autoUpdateToken();case 13:return r=this.authFactory(n),e.next=16,r.validateToken(this._token);case 16:return o=e.sent,this._roles=o.roles,e.abrupt("return",Promise.resolve());case 19:case"end":return e.stop()}}),e,this)}))),function(e){return l.apply(this,arguments)})},{key:"updateToken",value:(f=O(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.connection.updateToken(t);case 2:this._token=t,this.logger.debug("new token set");case 4:case"end":return e.stop()}}),e,this)}))),function(e){return f.apply(this,arguments)})},{key:"autoUpdateToken",value:(a=O(regeneratorRuntime.mark((function e(){var t,n,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.accountConfig.get("accountSid")){e.next=3;break}throw new c.c("Account sid not set");case 3:return this.logger.debug("updating token"),n=this.authFactory(t),e.prev=5,e.next=8,n.refreshToken(this.token);case 8:if(r=e.sent,this.isActive){e.next=12;break}return this.logger.trace("autoUpdateToken, session destroyed after refreshToken"),e.abrupt("return");case 12:return e.next=14,this.updateToken(r);case 14:this.logger.info("token auto-updated"),e.next=20;break;case 17:e.prev=17,e.t0=e.catch(5),this.logger.error("Failed to update token",e.t0);case 20:case"end":return e.stop()}}),e,this,[[5,17]])}))),function(){return a.apply(this,arguments)})},{key:"destroy",value:(i=O(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.isActive=!1,this.connection.removeListener(j.a.TokenAboutToExpire,this.handleTokenAboutToExpire),e.next=4,this.connection.destroy();case 4:case"end":return e.stop()}}),e,this)}))),function(){return i.apply(this,arguments)})},{key:"token",get:function(){return this._token}},{key:"roles",get:function(){return this._roles}}])&&C(t.prototype,n),r&&C(t,r),e}())||m,L=n(71),V=new o.ContainerModule((function(e){e(k.a).to(F).inSingletonScope(),e(k.b).toConstantValue(Object(L.a)())})),z=n(13),K=(n(5),n(9),n(22),n(26),n(15),n(63),n(64),n(41),n(34),n(38),n(31),n(40),n(30),n(16),n(97),n(27),n(17),n(36)),W=n(32),B=n(29),H=n(60);function G(e){return(G="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Q(e,t,n,r,o,i,c){try{var a=e[i](c),u=a.value}catch(e){return void n(e)}a.done?t(u):Promise.resolve(u).then(r,o)}function J(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function c(e){Q(i,r,o,c,a,"next",e)}function a(e){Q(i,r,o,c,a,"throw",e)}c(void 0)}))}}function $(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Y(e,t){return(Y=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function X(e,t){return!t||"object"!==G(t)&&"function"!=typeof t?Z(e):t}function Z(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ee(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function te(e){return(te=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ne(e,t){var n=t.get(e);if(!n)throw new TypeError("attempted to get private field on non-instance");return n.get?n.get.call(e):n.value}function re(e,t,n){var r=t.get(e);if(!r)throw new TypeError("attempted to set private field on non-instance");if(r.set)r.set.call(e,n);else{if(!r.writable)throw new TypeError("attempted to set read only private field");r.value=n}return n}var oe,ie,ce,ae,ue,se,fe=(E=Object(o.injectable)(),T=Object(o.postConstruct)(),E((A=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Y(e,t)}(l,e);var t,n,r,i,c,a,f=(t=l,function(){var e,n=te(t);if(ee()){var r=te(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return X(this,e)});function l(e,t,n,r,o,i,c){var a,s;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),a=f.call(this),D.set(Z(a),{writable:!0,value:void 0}),_.set(Z(a),{writable:!0,value:void 0}),q.set(Z(a),{writable:!0,value:void 0}),M.set(Z(a),{writable:!0,value:void 0}),U.set(Z(a),{writable:!0,value:void 0}),N.set(Z(a),{writable:!0,value:(s=J(regeneratorRuntime.mark((function e(){var t,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t=ne(Z(a),U),n=t.createEventGroup(B.b.Default),e.next=5,n.addEvents({eventName:B.c.ClientDestroyed,eventSource:B.d.Client});case 5:e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),ne(Z(a),q).error("Failed to send telemetry destroy event",e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])}))),function(){return s.apply(this,arguments)})}),re(Z(a),D,e),re(Z(a),_,t),a.config={account:n},re(Z(a),M,r),a.realtimeStats=o,re(Z(a),U,i),re(Z(a),q,c(u.b.Client)),a}return l=Object(o.inject)(u.d)(l,void 0,6)||l,l=Object(o.inject)(B.e)(l,void 0,5)||l,l=Object(o.inject)(H.b)(l,void 0,4)||l,l=Object(o.inject)(W.b)(l,void 0,3)||l,l=Object(o.inject)(s.b)(l,void 0,2)||l,l=Object(o.inject)(j.b)(l,void 0,1)||l,l=Object(o.inject)(S.a)(l,void 0,0)||l,n=l,(r=[{key:"setupProxies",value:function(){this.proxyEvent(ne(this,_),j.a.TokenAboutToExpire,z.a.TokenAboutToExpire),this.proxyEvent(ne(this,_),j.a.TokenExpired,z.a.TokenExpired),this.proxyEvent(ne(this,_),j.a.ConnectionError,z.a.ConnectionLost),this.proxyEvent(ne(this,_),j.a.Connected,z.a.ConnectionRestored),this.proxyEvent(ne(this,_),j.a.Disconnected,z.a.Disconnected)}},{key:"updateToken",value:(a=J(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ne(this,D).updateToken(t);case 2:case"end":return e.stop()}}),e,this)}))),function(e){return a.apply(this,arguments)})},{key:"destroy",value:(c=J(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ne(this,N).call(this);case 2:return ne(this,q).debug("client log out"),e.next=5,ne(this,D).destroy();case 5:this.removeAllListeners();case 6:case"end":return e.stop()}}),e,this)}))),function(){return c.apply(this,arguments)})},{key:"createTelemetryClient",value:function(e){return ne(this,M).call(this,e)}},{key:"roles",get:function(){return ne(this,D).roles}},{key:"token",get:function(){return ne(this,D).token}}])&&$(n.prototype,r),i&&$(n,i),l}(K.a),D=new WeakMap,_=new WeakMap,q=new WeakMap,M=new WeakMap,U=new WeakMap,N=new WeakMap,oe=(I=A).prototype,ie="setupProxies",ce=[T],ae=Object.getOwnPropertyDescriptor(I.prototype,"setupProxies"),ue=I.prototype,se={},Object.keys(ae).forEach((function(e){se[e]=ae[e]})),se.enumerable=!!se.enumerable,se.configurable=!!se.configurable,("value"in se||se.initializer)&&(se.writable=!0),se=ce.slice().reverse().reduce((function(e,t){return t(oe,ie,e)||e}),se),ue&&void 0!==se.initializer&&(se.value=se.initializer?se.initializer.call(ue):void 0,se.initializer=void 0),void 0===se.initializer&&(Object.defineProperty(oe,ie,se),se=null),R=I))||R),le=n(80),pe=n(72),de=new o.ContainerModule((function(e){e(z.d).to(pe.a).inSingletonScope(),e(z.c).to(fe).inSingletonScope(),e(z.b).toProvider((function(e){return function(t,n){return Object(le.a)(e.container,t,n)}}))})),ve=n(51),ye=n(57),be=new o.ContainerModule((function(e){e(ye.a).toDynamicValue((function(){return new ve.EventEmitter}))})),he=n(11);function me(e,t,n,r,o,i,c){try{var a=e[i](c),u=a.value}catch(e){return void n(e)}a.done?t(u):Promise.resolve(u).then(r,o)}var ge=function(){var e,t=(e=regeneratorRuntime.mark((function e(t){var n,r,o,i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.get(s.c),r=t.get(he.a),e.next=4,r.fetchConfiguration();case 4:return o=e.sent,n.set(o),i=t.get(s.b),e.abrupt("return",i);case 8:case"end":return e.stop()}}),e)})),function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function c(e){me(i,r,o,c,a,"next",e)}function a(e){me(i,r,o,c,a,"throw",e)}c(void 0)}))});return function(e){return t.apply(this,arguments)}}(),we=n(24);n(47),n(48);function ke(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Se(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var je,xe=function(){var e;return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ke(Object(n),!0).forEach((function(t){Se(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ke(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({authServiceUrl:"https://iam.twilio.com/v1/Accounts",twilioServiceLoginUrl:"https://flex.twilio.com/admin"},null===(e=window.__TWILIO_FLEX_SDK__)||void 0===e?void 0:e.environmentConfig)};n(53),n(68);function Oe(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}function Ce(e,t,n,r,o,i,c){try{var a=e[i](c),u=a.value}catch(e){return void n(e)}a.done?t(u):Promise.resolve(u).then(r,o)}function Pe(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Ee=Object(o.injectable)()(je=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.dataContainer=t,this.accountConfigUpdater=n}var t,n,r,i,c;return e=Object(o.inject)(we.c)(e,void 0,1)||e,e=Object(o.inject)(we.d)(e,void 0,0)||e,t=e,(n=[{key:"get",value:function(e){return this.dataContainer.get()[e]}},{key:"set",value:(i=regeneratorRuntime.mark((function e(t){var n,r,o,i,c,u=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.dataContainer.get(),r=n.accountSid,o=Oe(n,["accountSid"]),Object.keys(t).map((function(e){return Object(a.a)(e,o)})),i=function(){return u.accountConfigUpdater(r,t)},e.next=6,this.updateInCallOrder(i);case 6:return c=e.sent,this.dataContainer.set(c),e.abrupt("return",Promise.resolve());case 9:case"end":return e.stop()}}),e,this)})),c=function(){var e=this,t=arguments;return new Promise((function(n,r){var o=i.apply(e,t);function c(e){Ce(o,n,r,c,a,"next",e)}function a(e){Ce(o,n,r,c,a,"throw",e)}c(void 0)}))},function(e){return c.apply(this,arguments)})},{key:"updateInCallOrder",value:function(e){return this.currentUpdateConfigPromise?this.currentUpdateConfigPromise=this.currentUpdateConfigPromise.then((function(){return e()})):this.currentUpdateConfigPromise=e(),this.currentUpdateConfigPromise}}])&&Pe(t.prototype,n),r&&Pe(t,r),e}())||je,Te=(n(98),n(99),n(86),n(33));function Re(e,t,n,r,o,i,c){try{var a=e[i](c),u=a.value}catch(e){return void n(e)}a.done?t(u):Promise.resolve(u).then(r,o)}function Ie(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function c(e){Re(i,r,o,c,a,"next",e)}function a(e){Re(i,r,o,c,a,"throw",e)}c(void 0)}))}}var Ae=/^([a-z]+-[a-z]+-\d+)$/;function De(e){return function(e){return!!e.accountSid}(e)?{paramName:"AccountSid",paramValue:e.accountSid}:{paramName:"RuntimeDomain",paramValue:function(e){var t=e.trim();if(t.endsWith("/")&&(t=t.replace(/\/$/,"")),!t.endsWith(".twil.io")){var n=t.match(Ae);n&&n[1]&&(t+=".twil.io")}return t}(e.runtimeDomain)}}function _e(){return(_e=Ie(regeneratorRuntime.mark((function e(t,n){var r,o,i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.get(he.a),o=De(n),e.next=4,r.fetchPublicConfiguration(o.paramName,o.paramValue);case 4:if((i=e.sent)&&i.configurations&&i.configurations.length){e.next=7;break}throw new c.c("Invalid response from public configuration endpoint");case 7:return e.abrupt("return",Object(Te.c)(i.configurations[0]));case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function qe(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Me(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?qe(Object(n),!0).forEach((function(t){Ue(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):qe(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Ue(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Ne(e,t,n,r,o,i,c){try{var a=e[i](c),u=a.value}catch(e){return void n(e)}a.done?t(u):Promise.resolve(u).then(r,o)}var Fe,Le=function(){var e,t=(e=regeneratorRuntime.mark((function e(t,n,r){var o,i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=t.get(he.a),e.next=3,o.updateConfiguration(Me({accountSid:n},r));case 3:return i=e.sent,e.abrupt("return",i);case 5:case"end":return e.stop()}}),e)})),function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function c(e){Ne(i,r,o,c,a,"next",e)}function a(e){Ne(i,r,o,c,a,"throw",e)}c(void 0)}))});return function(e,n,r){return t.apply(this,arguments)}}(),Ve=n(73),ze=new o.ContainerModule((function(e){e(s.b).to(Ee).inSingletonScope(),e(s.c).to(Ve.a).inSingletonScope(),e(s.a).toProvider((function(e){return function(){return ge(e.container)}})),e(we.c).toDynamicValue((function(e){return function(t,n){return Le(e.container,t,n)}})),e(s.d).toDynamicValue(xe),e(s.e).toProvider((function(e){return function(t){return function(e,t){return _e.apply(this,arguments)}(e.container,t)}}))})),Ke=n(28),We=n(87);!function(e){e.TokenExpired="tokenExpired",e.TokenAboutToExpire="tokenAboutToExpire",e.StateChanged="stateChanged",e.ConnectionError="connectionError",e.Connected="connected",e.Disconnected="disconnected",e.TokenUpdated="tokenUpdated"}(Fe||(Fe={}));n(93);var Be=n(58),He=n.n(Be),Ge=n(70);function Qe(e){return(Qe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Je(e,t,n,r,o,i,c){try{var a=e[i](c),u=a.value}catch(e){return void n(e)}a.done?t(u):Promise.resolve(u).then(r,o)}function $e(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function c(e){Je(i,r,o,c,a,"next",e)}function a(e){Je(i,r,o,c,a,"throw",e)}c(void 0)}))}}var Ye;function Xe(e,t){return Ze.apply(this,arguments)}function Ze(){return(Ze=$e(regeneratorRuntime.mark((function e(t,n){var r,o,i,c,a,u,s,f=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=f.length>2&&void 0!==f[2]?f[2]:100,o=f.length>3&&void 0!==f[3]?f[3]:10,i=0,c=9e5,u=regeneratorRuntime.mark((function e(){var u,s,f;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,n&&i>0&&n.debug("Retry attempt: ",i),e.next=4,t();case 4:return e.t0=e.sent,e.abrupt("return",{v:e.t0});case 8:if(e.prev=8,e.t1=e.catch(0),429!==(null===(u=e.t1.reply)||void 0===u||null===(s=u.status)||void 0===s?void 0:s.code)){e.next=17;break}if(!(i>=o)){e.next=15;break}return a=e.t1,e.abrupt("return","break");case 15:e.next=18;break;case 17:return e.abrupt("return",{v:Promise.reject(e.t1)});case 18:return(f=Math.pow(1.5,i)*r)>c&&(f=c),e.next=22,new Promise((function(e){return setTimeout(e,f)}));case 22:case"end":return e.stop()}}),e,null,[[0,8]])}));case 5:return e.delegateYield(u(),"t0",6);case 6:s=e.t0,e.t1=s,e.next="break"===e.t1?10:11;break;case 10:return e.abrupt("break",14);case 11:if("object"!==Qe(s)){e.next=13;break}return e.abrupt("return",s.v);case 13:if(i++<o){e.next=5;break}case 14:return e.abrupt("return",Promise.reject(a));case 15:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function et(e){return(et="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function tt(e,t,n,r,o,i,c){try{var a=e[i](c),u=a.value}catch(e){return void n(e)}a.done?t(u):Promise.resolve(u).then(r,o)}function nt(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function c(e){tt(i,r,o,c,a,"next",e)}function a(e){tt(i,r,o,c,a,"throw",e)}c(void 0)}))}}function rt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ot(e,t,n){return(ot="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=ut(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function it(e,t){return(it=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function ct(e,t){return!t||"object"!==et(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function at(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function ut(e){return(ut=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var st,ft=Object(o.injectable)()(Ye=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&it(e,t)}(v,e);var t,n,r,i,a,f,l,p,d=(t=v,function(){var e,n=ut(t);if(at()){var r=ut(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return ct(this,e)});function v(e,t,n,r,o){var i;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,v),(i=d.call(this)).NewableTwilsockClient=e,i.productId=t,i.logger=n(u.b.Twilsock),i.logger.debug("Twilsock constructed"),i.environmentConfig=r,i.clientSettings=o,i}return v=Object(o.inject)(z.d)(v,void 0,4)||v,v=Object(o.inject)(s.d)(v,void 0,3)||v,v=Object(o.inject)(u.d)(v,void 0,2)||v,v=Object(o.inject)(Ke.b)(v,void 0,1)||v,v=Object(o.inject)(Ke.a)(v,void 0,0)||v,n=v,(r=[{key:"connect",value:(p=nt(regeneratorRuntime.mark((function e(t){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.twilsockClient){e.next=2;break}throw new c.c("Twilsock connection already exists");case 2:return n={region:this.clientSettings.region||this.environmentConfig.region,clientMetadata:{type:"flex-sdk",sdk:"JS",sdkv:Ge.a,app:this.clientSettings.appName,appv:this.clientSettings.appVersion}},this.twilsockClient=new this.NewableTwilsockClient(t,this.productId,n),this.proxyEventsFromTwilsockClient(),this.proxyLogsFromTwilsockClient(),this.twilsockClient.connect(),e.next=9,this.waitUntilConnectedOrRejected();case 9:case"end":return e.stop()}}),e,this)}))),function(e){return p.apply(this,arguments)})},{key:"proxyEventsFromTwilsockClient",value:function(){this.proxyEvent(this.getRawTwilsockClient(),Fe.TokenExpired,j.a.TokenExpired),this.proxyEvent(this.getRawTwilsockClient(),Fe.TokenAboutToExpire,j.a.TokenAboutToExpire),this.proxyEvent(this.getRawTwilsockClient(),Fe.StateChanged,j.a.StateChanged),this.proxyEvent(this.getRawTwilsockClient(),Fe.Connected,j.a.Connected),this.proxyEvent(this.getRawTwilsockClient(),Fe.Disconnected,j.a.Disconnected),this.listenAndEmitConnectionError()}},{key:"proxyLogsFromTwilsockClient",value:function(){var e=this,t=He.a.getLogger("twilsock");t.methodFactory=function(t){return function(){var n;return(n=e.logger)[t].apply(n,arguments)}},t.setLevel("trace")}},{key:"listenAndEmitConnectionError",value:function(){var e=this;this.getRawTwilsockClient().on(Fe.ConnectionError,(function(t){var n=t.errorCode||c.a.TwilsockConnectionError,r=new c.b(n,null==t?void 0:t.message);ot(ut(v.prototype),"emit",e).call(e,j.a.ConnectionError,r)}))}},{key:"updateToken",value:(l=nt(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.twilsockClient){e.next=2;break}throw new c.b(c.a.InvalidState,"no twilsock client");case 2:return e.prev=2,e.next=5,this.twilsockClient.updateToken(t);case 5:this.emit(j.a.TokenUpdated,t),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(2),Object(c.d)(e.t0);case 11:case"end":return e.stop()}}),e,this,[[2,8]])}))),function(e){return l.apply(this,arguments)})},{key:"waitUntilConnectedOrRejected",value:function(){var e=this;return new Promise((function(t,n){if(e.getRawTwilsockClient().isConnected)t();else{var r=function(){return t()},o=function(e){return n(e)},i=function(){e.removeListener(j.a.Connected,r),e.removeListener(j.a.ConnectionError,o)};e.on(j.a.Connected,(function(){i(),r()})),e.on(j.a.ConnectionError,(function(e){i(),o(e)}))}}))}},{key:"getRawTwilsockClient",value:function(){if(!this.twilsockClient)throw new c.c("Twilsock hasn't been initialized");return this.twilsockClient}},{key:"post",value:(f=nt(regeneratorRuntime.mark((function e(t,n,r){var o,i,a,u,s=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Xe((function(){return s.getRawTwilsockClient().post(t,n,r)}),this.logger);case 3:return e.abrupt("return",e.sent);case 6:throw e.prev=6,e.t0=e.catch(0),a=(null===(o=e.t0.body)||void 0===o?void 0:o.code)||c.a.SDK,u=(null===(i=e.t0.body)||void 0===i?void 0:i.message)||e.t0.message,new c.b(a,u,e.t0);case 11:case"end":return e.stop()}}),e,this,[[0,6]])}))),function(e,t,n){return f.apply(this,arguments)})},{key:"destroy",value:(a=nt(regeneratorRuntime.mark((function e(){var t,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.twilsockClient){e.next=2;break}return e.abrupt("return");case 2:return t=this.twilsockClient,n=new Promise((function(e){t.on(Fe.Disconnected,e)})),e.next=6,t.disconnect();case 6:return e.next=8,n;case 8:delete this.twilsockClient,this.removeAllListeners();case 10:case"end":return e.stop()}}),e,this)}))),function(){return a.apply(this,arguments)})}])&&rt(n.prototype,r),i&&rt(n,i),v}(K.a))||Ye,lt=new o.ContainerModule((function(e){e(Ke.a).toConstructor(We.TwilsockClient),e(Ke.b).toConstantValue("flex"),e(Ke.c).to(ft).inSingletonScope()})),pt=(n(54),n(55),Symbol.for("Rbac")),dt=function(e){return function(t){return e.get(S.a).roles.includes(t)}},vt=new o.ContainerModule((function(e){e(pt).toDynamicValue((function(e){return{requiredRole:(t=e.container,function(e){return function(n,r,o){var i=o.value,a=t.get(S.a);o.value=function(){var t=a.roles;if(!t.includes(e)){var n=t.length?t.toString():"no role";throw new c.b(c.a.Forbidden,"Expected the role ".concat(e,", but got ").concat(n," instead."))}for(var r=arguments.length,o=new Array(r),u=0;u<r;u++)o[u]=arguments[u];var s=i.apply(this,o);return s}}}),hasRole:dt(e.container)};var t}))})),yt=(n(44),n(14)),bt=n(74),ht=n(75);function mt(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var gt,wt=Object(o.injectable)()(st=function e(t){var n=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),mt(this,"trace",(function(){var e;(e=n.loglevel).trace.apply(e,arguments)})),mt(this,"debug",(function(){var e;(e=n.loglevel).debug.apply(e,arguments)})),mt(this,"log",(function(){var e;(e=n.loglevel).debug.apply(e,arguments)})),mt(this,"info",(function(){var e;(e=n.loglevel).info.apply(e,arguments)})),mt(this,"warn",(function(){var e;(e=n.loglevel).warn.apply(e,arguments)})),mt(this,"error",(function(){var e;(e=n.loglevel).error.apply(e,arguments)})),mt(this,"setLevel",(function(e){n.loglevel.setLevel(e)})),mt(this,"getLevel",(function(){return n.loglevel.getLevel()})),this.loglevel=t})||st,kt=function(e){return e<10?"0".concat(e):"".concat(e)},St=function(e){var t=e.getFullYear(),n=kt(e.getMonth()+1),r=kt(e.getDate()),o=kt(e.getHours()),i=kt(e.getMinutes()),c=kt(e.getSeconds()),a=kt(e.getMilliseconds());return"".concat(t,"-").concat(n,"-").concat(r," ").concat(o,":").concat(i,":").concat(c,".").concat(a)},jt=[function(e){return function(t,n,r){return function(o){for(var i=o instanceof u.a,c=arguments.length,a=new Array(c>1?c-1:0),s=1;s<c;s++)a[s-1]=arguments[s];i||a.unshift(o);var f=i?o:new u.a(r,t),l=e(t,n,r);return l.apply(void 0,[f].concat(a))}}},function(e){return function(t,n,r){return function(o){for(var i=e(t,n,r),c=arguments.length,a=new Array(c>1?c-1:0),u=1;u<c;u++)a[u-1]=arguments[u];return i.apply(void 0,[o].concat(a))}}},function(e){return function(t,n,r){return function(o){for(var i=arguments.length,c=new Array(i>1?i-1:0),a=1;a<i;a++)c[a-1]=arguments[a];o.data||(o.data=c);var u=e(t,n,r);return u.apply(void 0,[o].concat(c))}}},function(e){return function(t,n,r){return function(o){for(var i=St(o.timestamp),c=o.severity.toUpperCase(),a="[".concat(i,"] Flex SDK → ").concat(r," (").concat(c,"): "),u=e(t,n,r),s=arguments.length,f=new Array(s>1?s-1:0),l=1;l<s;l++)f[l-1]=arguments[l];return u.apply(void 0,[a].concat(f))}}}].reverse(),xt=function(e){return jt.forEach((function(t){var n=e.methodFactory;e.methodFactory=t(n)})),e.setLevel(e.getLevel()),e},Ot=new o.ContainerModule((function(e){e(yt.e).toConstantValue(Be.getLogger),e(yt.b).toFactory((function(e){return Object(bt.a)(e.container)})),e(yt.f).toConstructor(wt),e(yt.a).toConstantValue([xt]),e(yt.d).toConstantValue(Object(ht.a)()),e(yt.c).toConstantValue(new Map)})),Ct=n(10),Pt=n(25),Et=n(52),Tt=n(49);function Rt(e){return(Rt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function It(e,t,n,r,o,i,c){try{var a=e[i](c),u=a.value}catch(e){return void n(e)}a.done?t(u):Promise.resolve(u).then(r,o)}function At(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function c(e){It(i,r,o,c,a,"next",e)}function a(e){It(i,r,o,c,a,"throw",e)}c(void 0)}))}}function Dt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function _t(e,t){return(_t=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function qt(e,t){return!t||"object"!==Rt(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Mt(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function Ut(e){return(Ut=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Nt=Object(o.injectable)()(gt=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_t(e,t)}(v,e);var t,n,r,i,a,f,l,p,d=(t=v,function(){var e,n=Ut(t);if(Mt()){var r=Ut(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return qt(this,e)});function v(e,t,n,r,o,i){var c;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,v),(c=d.call(this)).NewableSyncClient=e,c.logger=t(u.b.Sync),c.twilsock=n,c.environmentConfig=r,c.clientSettings=o,c.syncMapProvider=i,c}return v=Object(o.inject)(Ct.f)(v,void 0,5)||v,v=Object(o.inject)(z.d)(v,void 0,4)||v,v=Object(o.inject)(s.d)(v,void 0,3)||v,v=Object(o.inject)(j.b)(v,void 0,2)||v,v=Object(o.inject)(u.d)(v,void 0,1)||v,v=Object(o.inject)(Ct.a)(v,void 0,0)||v,n=v,(r=[{key:"isConnected",value:function(){var e;return(null===(e=this.syncClient)||void 0===e?void 0:e.connectionState)===Pt.c.Connected}},{key:"connect",value:(p=At(regeneratorRuntime.mark((function e(t,n){var r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.syncClient){e.next=2;break}return e.abrupt("return");case 2:return r={region:this.clientSettings.region||this.environmentConfig.region,productId:n},this.syncClient=new this.NewableSyncClient(t,r),e.next=6,this.waitUntilConnectedOrRejected();case 6:this.listenOnTokenUpdateEvent(),this.listenOnDisconnectEvent();case 8:case"end":return e.stop()}}),e,this)}))),function(e,t){return p.apply(this,arguments)})},{key:"waitUntilConnectedOrRejected",value:(l=At(regeneratorRuntime.mark((function e(){var t=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,n){t.syncClient.connectionState===Pt.c.Connected&&e(),t.syncClient.on(Pt.b.ConnectionStateChanged,(function(r){t.logger.debug("Connection state changed: ".concat(r)),r===Pt.c.Connected&&e(),r===Pt.c.Error&&t.syncClient.removeAllListeners(),[Pt.c.Error,Pt.c.Disconnected,Pt.c.Denied].includes(r)&&n(new c.b(c.a.SyncConnectionError))}))})));case 1:case"end":return e.stop()}}),e)}))),function(){return l.apply(this,arguments)})},{key:"listenOnTokenUpdateEvent",value:function(){var e=this,t=function(){var t=At(regeneratorRuntime.mark((function t(n){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.syncClient.updateToken(n);case 3:t.next=8;break;case 5:t.prev=5,t.t0=t.catch(0),Object(c.d)(t.t0);case 8:case"end":return t.stop()}}),t,null,[[0,5]])})));return function(e){return t.apply(this,arguments)}}();this.twilsock.on(j.a.TokenUpdated,t)}},{key:"listenOnDisconnectEvent",value:function(){var e=this,t=function(){var t=At(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.destroy();case 3:t.next=8;break;case 5:t.prev=5,t.t0=t.catch(0),Object(c.d)(t.t0);case 8:case"end":return t.stop()}}),t,null,[[0,5]])})));return function(){return t.apply(this,arguments)}}();this.twilsock.on(j.a.Disconnected,t)}},{key:"getMapById",value:(f=At(regeneratorRuntime.mark((function e(t){var n,r=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=r.length>1&&void 0!==r[1]?r[1]:Et.a.OpenExisting,this.syncClient){e.next=3;break}throw new c.c("Sync client hasn't been initialized");case 3:return e.abrupt("return",this.syncMapProvider(this.syncClient,t,n));case 4:case"end":return e.stop()}}),e,this)}))),function(e){return f.apply(this,arguments)})},{key:"destroy",value:(a=At(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.emit(Tt.a.Destroyed),this.syncClient){e.next=3;break}return e.abrupt("return");case 3:return e.next=5,this.syncClient.shutdown();case 5:this.syncClient.removeAllListeners(),this.logger.debug("Sync client destroyed");case 7:case"end":return e.stop()}}),e,this)}))),function(){return a.apply(this,arguments)})}])&&Dt(n.prototype,r),i&&Dt(n,i),v}(K.a))||gt;function Ft(e,t,n,r,o,i,c){try{var a=e[i](c),u=a.value}catch(e){return void n(e)}a.done?t(u):Promise.resolve(u).then(r,o)}function Lt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Vt,zt=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.syncSdkSyncMap=t,this.syncMapItemProvider=n}var t,n,r;return t=e,(n=[{key:"get",value:function(){var e,t=(e=regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.syncMapItemProvider(this.syncSdkSyncMap,t));case 1:case"end":return e.stop()}}),e,this)})),function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function c(e){Ft(i,r,o,c,a,"next",e)}function a(e){Ft(i,r,o,c,a,"throw",e)}c(void 0)}))});return function(e){return t.apply(this,arguments)}}()},{key:"on",value:function(e,t){this.syncSdkSyncMap.on(e,t)}},{key:"removeListener",value:function(e,t){this.syncSdkSyncMap.removeListener(e,t)}},{key:"sid",get:function(){return this.syncSdkSyncMap.sid}},{key:"dateUpdated",get:function(){return this.syncSdkSyncMap.dateUpdated}},{key:"uniqueName",get:function(){return this.syncSdkSyncMap.uniqueName}}])&&Lt(t.prototype,n),r&&Lt(t,r),e}(),Kt=(n(100),n(101),n(45));function Wt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Bt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Wt(Object(n),!0).forEach((function(t){Gt(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Wt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Ht(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Gt(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}!function(e){e.ItemUpdated="itemUpdated"}(Vt||(Vt={}));var Qt={mapKeysToCamelCase:!0,dateFields:["timestampUpdated"]},Jt=function(){function e(t,n){var r=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),Gt(this,"subscribableSubItems",new Map),Gt(this,"subscribers",[]),Gt(this,"subscribe",(function(e){r.subscribers.push(e),1===r.subscribers.length&&r.syncMap.on(Vt.ItemUpdated,r.itemUpdatedHandler)})),Gt(this,"unsubscribe",(function(e){var t=r.subscribers.indexOf(e);t<0||(r.subscribers.splice(t,1),0===r.subscribers.length&&r.syncMap.removeListener(Vt.ItemUpdated,r.itemUpdatedHandler))})),Gt(this,"itemUpdatedHandler",(function(e){var t=e.item;t.key===r.key&&(r.updateValue(t.value),r.subscribers.forEach((function(e){return e()})))})),this.syncMap=t,this.itemKey=n.key,this._value=n.value}var t,n,r;return t=e,(n=[{key:"getSubscribable",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(!this.subscribable){var t=Bt({},Qt,{},e);this.subscribable={options:t,value:Object(Kt.a)(this._value,t,this.subscribe,this.unsubscribe)}}return this.subscribable.value}},{key:"getSubscribableForSubKey",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=this.subscribableSubItems.get(e);if(!n){var r=this.getSubValue(e),o=Bt({},Qt,{},t),i=Object(Kt.a)(r,o,this.subscribe,this.unsubscribe);n={options:o,value:i},this.subscribableSubItems.set(e,n)}return n.value}},{key:"updateValue",value:function(e){var t=this;if(this._value=e,this.subscribable){var n=Object(Kt.a)(e,this.subscribable.options,this.subscribe,this.unsubscribe);this.deleteRemovedSubKeys(this.subscribable.value,n),Object.assign(this.subscribable.value,Bt({},n))}this.subscribableSubItems.forEach((function(e,n){var r=t.getSubValue(n),o=Object(Kt.a)(r,e.options,t.subscribe,t.unsubscribe);t.deleteRemovedSubKeys(e.value,o),Object.assign(e.value,Bt({},o))}))}},{key:"deleteRemovedSubKeys",value:function(e,t){var n=e;Object.keys(n).filter((function(e){return!Object.prototype.hasOwnProperty.call(t,e)})).forEach((function(e){delete n[e]}))}},{key:"isIndexObject",value:function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}},{key:"getSubValue",value:function(e){if(this.isIndexObject(this.value,e))return this.value[e];throw new c.c("Key ".concat(e," does not exist in item ").concat(this.itemKey))}},{key:"key",get:function(){return this.itemKey}},{key:"value",get:function(){return this._value}}])&&Ht(t.prototype,n),r&&Ht(t,r),e}();function $t(e,t,n,r,o,i,c){try{var a=e[i](c),u=a.value}catch(e){return void n(e)}a.done?t(u):Promise.resolve(u).then(r,o)}function Yt(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function c(e){$t(i,r,o,c,a,"next",e)}function a(e){$t(i,r,o,c,a,"throw",e)}c(void 0)}))}}function Xt(){return(Xt=Yt(regeneratorRuntime.mark((function e(t,n,r,o){var i,a,u,s,f,l;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,n.map({id:r,mode:o});case 3:return i=e.sent,a=t.get(Ct.c),u=t.get(Ct.e),s=new a(i,u),e.abrupt("return",s);case 10:throw e.prev=10,e.t0=e.catch(0),f=e.t0.code,l=e.t0.message,new c.b(f||c.a.SDK,l);case 15:case"end":return e.stop()}}),e,null,[[0,10]])})))).apply(this,arguments)}function Zt(e,t,n,r,o,i,c){try{var a=e[i](c),u=a.value}catch(e){return void n(e)}a.done?t(u):Promise.resolve(u).then(r,o)}function en(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function c(e){Zt(i,r,o,c,a,"next",e)}function a(e){Zt(i,r,o,c,a,"throw",e)}c(void 0)}))}}function tn(){return(tn=en(regeneratorRuntime.mark((function e(t,n,r){var o,i,a,u,s;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,n.get(r);case 3:return o=e.sent,i=t.get(Ct.b),a=new i(n,o),e.abrupt("return",a);case 9:throw e.prev=9,e.t0=e.catch(0),u=e.t0.code,s=e.t0.message,new c.b(u||c.a.SDK,s);case 14:case"end":return e.stop()}}),e,null,[[0,9]])})))).apply(this,arguments)}function nn(e,t,n,r,o,i,c){try{var a=e[i](c),u=a.value}catch(e){return void n(e)}a.done?t(u):Promise.resolve(u).then(r,o)}var rn,on=function(){var e,t=(e=regeneratorRuntime.mark((function e(t,n){var r,o,i,c;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.get(Ct.d),o=r.get(n)){e.next=17;break}return i=function(){r.delete(n)},o=t.get(Ct.h),r.set(n,o),o.on(Tt.a.Destroyed,i),c=t.get(S.a),e.prev=8,e.next=11,o.connect(c.token,n);case 11:e.next=17;break;case 13:throw e.prev=13,e.t0=e.catch(8),r.delete(n),e.t0;case 17:return e.abrupt("return",o);case 18:case"end":return e.stop()}}),e,null,[[8,13]])})),function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function c(e){nn(i,r,o,c,a,"next",e)}function a(e){nn(i,r,o,c,a,"throw",e)}c(void 0)}))});return function(e,n){return t.apply(this,arguments)}}(),cn=new o.ContainerModule((function(e){e(Ct.a).toConstructor(Pt.a),e(Ct.h).to(Nt),e(Ct.c).toConstructor(zt),e(Ct.b).toConstructor(Jt),e(Ct.f).toProvider((function(e){return function(t,n,r){return function(e,t,n,r){return Xt.apply(this,arguments)}(e.container,t,n,r)}})),e(Ct.e).toProvider((function(e){return function(t,n){return function(e,t,n){return tn.apply(this,arguments)}(e.container,t,n)}})),e(Ct.g).toProvider((function(e){return function(t){return on(e.container,t)}})),e(Ct.d).toConstantValue(new Map)})),an=n(12);n(35);function un(e,t,n,r,o,i,c){try{var a=e[i](c),u=a.value}catch(e){return void n(e)}a.done?t(u):Promise.resolve(u).then(r,o)}function sn(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var fn,ln=Object(o.injectable)()(rn=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.eventGroupFactory=t,this.logger=n(u.c.TelemetryClient)}var t,n,r,i,c;return e=Object(o.inject)(u.d)(e,void 0,1)||e,e=Object(o.inject)(an.c)(e,void 0,0)||e,t=e,(n=[{key:"createEventGroup",value:function(e){return this.logger.debug("creating event group with name: ",e),this.eventGroupFactory(this,e)}},{key:"setSessionData",value:(i=regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.sessionData=t;case 1:case"end":return e.stop()}}),e,this)})),c=function(){var e=this,t=arguments;return new Promise((function(n,r){var o=i.apply(e,t);function c(e){un(o,n,r,c,a,"next",e)}function a(e){un(o,n,r,c,a,"throw",e)}c(void 0)}))},function(e){return c.apply(this,arguments)})}])&&sn(t.prototype,n),r&&sn(t,r),e}())||rn;function pn(e,t,n,r,o,i,c){try{var a=e[i](c),u=a.value}catch(e){return void n(e)}a.done?t(u):Promise.resolve(u).then(r,o)}function dn(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function c(e){pn(i,r,o,c,a,"next",e)}function a(e){pn(i,r,o,c,a,"throw",e)}c(void 0)}))}}function vn(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var yn,bn=Object(o.injectable)()(fn=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.processor=t}var t,n,r,i,c;return e=Object(o.inject)(an.e)(e,void 0,0)||e,t=e,(n=[{key:"addEvents",value:(c=dn(regeneratorRuntime.mark((function e(){var t,n,r,o,i=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(n=i.length,r=new Array(n),o=0;o<n;o++)r[o]=i[o];return e.abrupt("return",(t=this.processor).processEvents.apply(t,[this.telemetryClient.name,this.name,this.telemetryClient.sessionData].concat(r)));case 2:case"end":return e.stop()}}),e,this)}))),function(){return c.apply(this,arguments)})},{key:"addErrorEvent",value:(i=dn(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.processor.processEvents("error-v1",this.name,void 0,t));case 1:case"end":return e.stop()}}),e,this)}))),function(e){return i.apply(this,arguments)})}])&&vn(t.prototype,n),r&&vn(t,r),e}())||fn;n(65);function hn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function mn(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?hn(Object(n),!0).forEach((function(t){gn(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):hn(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function gn(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function wn(e,t,n,r){var o,i=void 0===r?{}:Object(Te.a)(r),a=mn({},Object(Te.a)(t),{client_timestamp:(new Date).toISOString(),event_group:n});if(o=a,Object.prototype.hasOwnProperty.call(o,"event_name")&&Object.prototype.hasOwnProperty.call(o,"client_timestamp"))return{payload_type:e,payload:mn({},a,{},i)};throw new c.b(c.a.InvalidParams,"Telemetry event has missing fields")}function kn(e,t,n){for(var r=arguments.length,o=new Array(r>3?r-3:0),i=3;i<r;i++)o[i-3]=arguments[i];return o.map((function(r){return wn(e,r,t,n)}))}function Sn(e){return function(e){if(Array.isArray(e))return jn(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return jn(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return jn(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function jn(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function xn(e,t,n,r,o,i,c){try{var a=e[i](c),u=a.value}catch(e){return void n(e)}a.done?t(u):Promise.resolve(u).then(r,o)}function On(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function c(e){xn(i,r,o,c,a,"next",e)}function a(e){xn(i,r,o,c,a,"throw",e)}c(void 0)}))}}function Cn(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Pn=Object(o.injectable)()(yn=function(){function e(t,n){var r,o,i;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),i=!1,(o="isTelemetryDisabled")in(r=this)?Object.defineProperty(r,o,{value:i,enumerable:!0,configurable:!0,writable:!0}):r[o]=i,this.logger=t(u.c.TelemetryProcessor),this.telemetryService=n}var t,n,r,i,c;return e=Object(o.inject)(he.e)(e,void 0,1)||e,e=Object(o.inject)(u.d)(e,void 0,0)||e,t=e,(n=[{key:"processEvents",value:(c=On(regeneratorRuntime.mark((function e(t,n,r){var o,i,c,a,u,s,f,l=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.isTelemetryDisabled){e.next=3;break}return this.logger.trace("Events not sent: telemetry disabled"),e.abrupt("return");case 3:for(this.logger.debug("common attributes:",r),o=l.length,i=new Array(o>3?o-3:0),c=3;c<o;c++)i[c-3]=l[c];if(!(a=kn.apply(void 0,[t,n,r].concat(i)))){e.next=11;break}for(s=[],f=0;f<a.length;f+=50)u=a.slice(f,f+50),s.push(this.sendTelemetryEvents.apply(this,Sn(u)));return e.next=11,Promise.all(s);case 11:case"end":return e.stop()}}),e,this)}))),function(e,t,n){return c.apply(this,arguments)})},{key:"sendTelemetryEvents",value:(i=On(regeneratorRuntime.mark((function e(){var t,n,r,o,i=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(t=i.length,n=new Array(t),r=0;r<t;r++)n[r]=i[r];return this.logger.debug("Sending",n.length,"telemetry events"),this.logger.trace("Events",n),e.prev=3,e.next=6,this.telemetryService.postTelemetryEvents({events:n});case 6:this.logger.debug("Telemetry sent successfully"),e.next=17;break;case 9:if(e.prev=9,e.t0=e.catch(3),409!==(null===(o=e.t0.source)||void 0===o?void 0:o.status)){e.next=16;break}return this.logger.warn("Telemetry is disabled for this account"),this.isTelemetryDisabled=!0,e.abrupt("return");case 16:throw e.t0;case 17:case"end":return e.stop()}}),e,this,[[3,9]])}))),function(){return i.apply(this,arguments)})}])&&Cn(t.prototype,n),r&&Cn(t,r),e}())||yn,En=new o.ContainerModule((function(e){e(an.a).toFactory((function(e){return function(t){return Object(W.a)(e.container,t)}})),e(an.b).to(ln),e(an.c).toFactory((function(e){return function(t,n){return function(e,t,n){var r=e.get(an.d);return r.name=n,r.telemetryClient=t,r}(e.container,t,n)}})),e(an.d).to(bn),e(an.e).to(Pn).inSingletonScope()})),Tn=n(21);function Rn(e,t,n,r,o,i,c){try{var a=e[i](c),u=a.value}catch(e){return void n(e)}a.done?t(u):Promise.resolve(u).then(r,o)}function In(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function c(e){Rn(i,r,o,c,a,"next",e)}function a(e){Rn(i,r,o,c,a,"throw",e)}c(void 0)}))}}function An(){return(An=In(regeneratorRuntime.mark((function e(t,n){var r,o,i,a,u,s;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.get(Tn.e),o=r(n),i=t.get(Tn.a),a=t.get(he.c),e.prev=4,e.next=7,a.getMetadata(n);case 7:return u=e.sent,s=new i(n,a,o,u),e.abrupt("return",s);case 12:if(e.prev=12,e.t0=e.catch(4),e.t0.code!==c.a.SyncNameNotFoundError){e.next=16;break}throw new c.b(c.a.NotFound,"Metadata statistics of the queue: ".concat(n),e.t0);case 16:throw e.t0;case 17:case"end":return e.stop()}}),e,null,[[4,12]])})))).apply(this,arguments)}function Dn(e,t,n,r,o,i,c){try{var a=e[i](c),u=a.value}catch(e){return void n(e)}a.done?t(u):Promise.resolve(u).then(r,o)}function _n(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function c(e){Dn(i,r,o,c,a,"next",e)}function a(e){Dn(i,r,o,c,a,"throw",e)}c(void 0)}))}}function qn(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Mn=function(){function e(t,n,r,o){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.sid=t,this.queueStatsService=n,this.tasks=r;var i=o.getSubscribable();this.friendlyName=i.queueFriendlyName||""}var t,n,r,o,i,a;return t=e,(n=[{key:"getWorkerStats",value:(a=_n(regeneratorRuntime.mark((function e(){var t,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.queueStatsService.getWorkerStats(this.sid);case 3:return t=e.sent,n={mapKeysToCamelCase:!0,dateFields:["timestampUpdated"]},e.abrupt("return",t.getSubscribable(n));case 8:if(e.prev=8,e.t0=e.catch(0),e.t0.code!==c.a.SyncNameNotFoundError){e.next=12;break}throw new c.b(c.a.NotFound,"Worker statistics of the queue: ".concat(this.sid),e.t0);case 12:throw e.t0;case 13:case"end":return e.stop()}}),e,this,[[0,8]])}))),function(){return a.apply(this,arguments)})},{key:"getTaskChannelStats",value:(i=_n(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Promise.reject(new Error("Not implemented")));case 1:case"end":return e.stop()}}),e)}))),function(){return i.apply(this,arguments)})},{key:"getAllTaskChannelStats",value:(o=_n(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Promise.reject(new Error("Not implemented")));case 1:case"end":return e.stop()}}),e)}))),function(){return o.apply(this,arguments)})}])&&qn(t.prototype,n),r&&qn(t,r),e}();function Un(e,t,n,r,o,i,c){try{var a=e[i](c),u=a.value}catch(e){return void n(e)}a.done?t(u):Promise.resolve(u).then(r,o)}function Nn(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function c(e){Un(i,r,o,c,a,"next",e)}function a(e){Un(i,r,o,c,a,"throw",e)}c(void 0)}))}}function Fn(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Ln,Vn=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.queueSid=t,this.queueStatsService=n}var t,n,r,o,i;return t=e,(n=[{key:"getCurrentTasks",value:(i=Nn(regeneratorRuntime.mark((function e(){var t,n,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.queueStatsService.getCurrentTasksStats(this.queueSid);case 3:return t=e.sent,n={mapKeysToCamelCase:!0,dateFields:["timestampUpdated","longestTaskWaitingFrom"]},r=t.getSubscribableForSubKey("queue",n),e.abrupt("return",r);case 9:if(e.prev=9,e.t0=e.catch(0),e.t0.code!==c.a.SyncNameNotFoundError){e.next=13;break}throw new c.b(c.a.NotFound,"Statistics for current tasks of the queue: ".concat(this.queueSid),e.t0);case 13:throw e.t0;case 14:case"end":return e.stop()}}),e,this,[[0,9]])}))),function(){return i.apply(this,arguments)})},{key:"getForPeriod",value:(o=Nn(regeneratorRuntime.mark((function e(t){var n,r,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Object(a.b)(t,"period"),e.prev=1,e.next=4,this.queueStatsService.getHistoricalStats(this.queueSid,t);case 4:return n=e.sent,r={mapKeysToCamelCase:!0,dateFields:["timestampUpdated"]},o=n.getSubscribableForSubKey("queue",r),e.abrupt("return",o);case 10:if(e.prev=10,e.t0=e.catch(1),e.t0.code!==c.a.SyncNameNotFoundError){e.next=14;break}throw new c.b(c.a.NotFound,"Historical statistics for the period ".concat(t," of the queue: ").concat(this.queueSid),e.t0);case 14:throw e.t0;case 15:case"end":return e.stop()}}),e,this,[[1,10]])}))),function(e){return o.apply(this,arguments)})}])&&Fn(t.prototype,n),r&&Fn(t,r),e}();function zn(e,t,n,r,o,i,c){try{var a=e[i](c),u=a.value}catch(e){return void n(e)}a.done?t(u):Promise.resolve(u).then(r,o)}function Kn(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Wn=Object(o.injectable)()(Ln=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.getQueueStats=t,this.rbac=n}var t,n,r,i,a;return e=Object(o.inject)(pt)(e,void 0,1)||e,e=Object(o.inject)(Tn.c)(e,void 0,0)||e,t=e,(n=[{key:"validatePermissions",value:function(){if(!this.rbac.hasRole("supervisor")&&!this.rbac.hasRole("admin"))throw new c.b(c.a.PermissionDeniedError)}},{key:"getQueueStatsBySid",value:(i=regeneratorRuntime.mark((function e(t){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.validatePermissions(),e.next=3,this.getQueueStats(t);case 3:return n=e.sent,e.abrupt("return",n);case 5:case"end":return e.stop()}}),e,this)})),a=function(){var e=this,t=arguments;return new Promise((function(n,r){var o=i.apply(e,t);function c(e){zn(o,n,r,c,a,"next",e)}function a(e){zn(o,n,r,c,a,"throw",e)}c(void 0)}))},function(e){return a.apply(this,arguments)})}])&&Kn(t.prototype,n),r&&Kn(t,r),e}())||Ln,Bn=new o.ContainerModule((function(e){e(Tn.d).to(Wn).inSingletonScope(),e(Tn.a).toConstructor(Mn),e(Tn.c).toProvider((function(e){return function(t){return function(e,t){return An.apply(this,arguments)}(e.container,t)}})),e(Tn.b).toConstructor(Vn),e(Tn.e).toFactory((function(e){return function(t){return function(e,t){return new(e.get(Tn.b))(t,e.get(he.c))}(e.container,t)}}))})),Hn=n(56),Gn=new o.ContainerModule((function(e){e(Hn.a).toDynamicValue((function(e){return Object(W.a)(e.container,"sdk-v1")})).inSingletonScope()})),Qn=n(81),Jn=n(82),$n=n(79),Yn=n(76),Xn=n(77),Zn=n(78);function er(){var e=new o.Container;return e.load(w),e.load(ze),e.load(V),e.load(de),e.load(be),e.load(lt),e.load(vt),e.load(Ot),e.load(cn),e.load(En),e.load(Gn),e.load(Bn),function(e){e.bind(he.d).to(Yn.a).inSingletonScope(),e.bind(he.f).to(Xn.a).inSingletonScope(),e.bind(he.b).to(Zn.a).inSingletonScope(),Qn.a.with(e),Jn.a.with(e),$n.a.with(e)}(e),e}},function(e,t){e.exports=require("reflect-metadata")},function(e,t){e.exports=require("core-js/modules/es.reflect.get")},function(e,t){e.exports=require("core-js/modules/es.array.find")},function(e,t){e.exports=require("core-js/modules/es.number.constructor")},function(e,t){e.exports=require("core-js/modules/es.number.is-nan")},function(e,t){e.exports=require("core-js/modules/es.weak-map")},function(e,t){e.exports=require("core-js/modules/es.string.ends-with")},function(e,t){e.exports=require("core-js/modules/es.string.match")},function(e,t){e.exports=require("core-js/modules/es.array.splice")},function(e,t){e.exports=require("core-js/modules/es.object.assign")},function(e,t){e.exports=require("core-js/modules/es.object.entries")},function(e,t){e.exports=require("core-js/modules/es.regexp.constructor")},function(e,t){e.exports=require("core-js/modules/es.string.split")},function(e,t){e.exports=require("core-js/modules/es.string.starts-with")},function(e,t,n){"use strict";n.r(t),n.d(t,"auth",(function(){return p})),n.d(t,"getLogger",(function(){return d})),n.d(t,"getTwilioIdpUrl",(function(){return v})),n.d(t,"getPublicConfig",(function(){return y})),n.d(t,"createClient",(function(){return b})),n.d(t,"version",(function(){return h}));var r=n(70),o=n(91),i=n(6),c=n(13),a=n(37),u=n(3);n.d(t,"LoggerName",(function(){return u.b})),n.d(t,"ClientEvent",(function(){return c.a}));var s=n(60);n.d(t,"TimeSpan",(function(){return s.a}));var f=n(1);n.d(t,"ErrorCode",(function(){return f.a})),n.d(t,"FlexSdkError",(function(){return f.b}));var l=Object(o.a)(),p=l.get(a.a),d=l.get(u.d),v=l.get(a.c),y=l.get(i.e),b=l.get(c.b),h=r.a}]);
//# sourceMappingURL=index.js.map